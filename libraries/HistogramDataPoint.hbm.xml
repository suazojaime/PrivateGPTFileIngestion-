<?xml version="1.0"?>
<!-- Copyright (c) 2019 Caterpillar -->

<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping package="minestar.health.domain.data" schema="historical">

    <class name="HistogramDataPointVims3" table="HISTOGRAM_VIMS3_DETAILS">
        <meta attribute="noDatabaseMetadata" inherit="false">true</meta>
        <meta attribute="table">
            tablespace=MW_OBJ
        </meta>
        <meta attribute="primary-key">
            tablespace=MW_IDXOBJ
        </meta>
        <meta attribute="index">
            name=HIST_VIMS3_UNIQ
            unique=true
            columns=HEALTH_LOG_OID, HISTOGRAM, TIMESTAMP_UTC, CELL
            tablespace=MW_IDXENT
        </meta>
        <meta attribute="index">
            name=HIST_VIMS3_TIME
            unique=false
            columns=TIMESTAMP_UTC
            tablespace=MW_IDXENT
        </meta>
        <meta attribute="foreign-key">
            on-delete=CASCADE
        </meta>

        <id name="oid">
            <generator class="uuid.hex"/>
        </id>

        <many-to-one name="log" class="minestar.health.api.frame.HealthLog" column="HEALTH_LOG_OID" not-null="true">
            <meta attribute="alias">parentOID</meta>
        </many-to-one>

        <property name="serialNumber" column="SERIALNUMBER" type="string" length="32" not-null="true"/>

        <property name="timestamp" type="TimestampType">
            <meta attribute="timestamp">true</meta>
            <meta attribute="view-localtime">true</meta>
            <meta attribute="utc-description">The utc timestamp.</meta>
            <meta attribute="description">The timestamp.</meta>
            <column name="TIMESTAMP_UTC" not-null="true" default="01-JAN-1970"/>
        </property>

        <property name="listIndex" column="LISTINDEX" type="int" not-null="true">
        </property>

        <property name="histogram" type="java.lang.Integer" column="HISTOGRAM" not-null="true">
            <meta attribute="manyToOne" inherit="false">minestar.health.domain.metadata.HistogramDef</meta>
            <meta attribute="propertyRef" inherit="false">oid</meta>
        </property>

        <property name="cellNumber" column="CELL" not-null="true">
        </property>
        <property name="histogramOid" column="HISTOGRAM_OID"/>

        <dynamic-component name="data">
            <property name="VALUE" column="VALUE" type="long">
                <meta attribute="universe-type-measure">true</meta>
            </property>
        </dynamic-component>
    </class>


    <class name="HistogramDataPoint" table="HISTOGRAM_DETAILS">
        <meta attribute="noDatabaseMetadata" inherit="false">true</meta>
        <meta attribute="table">
            tablespace=MW_OBJ
        </meta>
        <meta attribute="primary-key">
            tablespace=MW_IDXOBJ
        </meta>
        <meta attribute="index">
            name=HIST_UNIQ
            unique=true
            columns=HEALTH_LOG_OID, HISTOGRAM, TIMESTAMP_UTC, CELL
            tablespace=MW_IDXENT
        </meta>
        <meta attribute="index">
            name=HIST_TIME
            unique=false
            columns=TIMESTAMP_UTC
            tablespace=MW_IDXENT
        </meta>
        <meta attribute="foreign-key">
            on-delete=CASCADE
        </meta>

        <id name="oid">
            <generator class="uuid.hex"/>
        </id>

        <many-to-one name="log" class="minestar.health.api.frame.HealthLog" column="HEALTH_LOG_OID" not-null="true">
            <meta attribute="alias">parentOID</meta>
        </many-to-one>


        <property name="serialNumber" column="SERIALNUMBER" type="string" length="32" not-null="true"/>

        <property name="timestamp" type="TimestampType">
            <meta attribute="timestamp">true</meta>
            <meta attribute="view-localtime">true</meta>
            <meta attribute="utc-description">The utc timestamp.</meta>
            <meta attribute="description">The timestamp.</meta>
            <column name="TIMESTAMP_UTC" not-null="true" default="01-JAN-1970"/>
        </property>

        <property name="listIndex" column="LISTINDEX" type="int" not-null="true">
        </property>

        <property name="histogram" type="java.lang.Integer" column="HISTOGRAM" not-null="true">
            <meta attribute="manyToOne" inherit="false">minestar.health.domain.metadata.HistogramDef</meta>
            <meta attribute="propertyRef" inherit="false">oid</meta>
        </property>

        <property name="cellNumber" column="CELL" not-null="true">
        </property>

        <dynamic-component name="data">
            <property name="VALUE" column="VALUE" type="long">
                <meta attribute="universe-type-measure">true</meta>
            </property>
        </dynamic-component>

    </class>

</hibernate-mapping>
