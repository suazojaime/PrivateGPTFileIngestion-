<?xml version="1.0"?>
<kpiSummaries>
    <fact name="main">
        <!-- SMU Activity measures -->
        <measure if="prod" name="loadingSmuDuration" expr="cycle.activities.loadingSmuDuration" unitType="duration" category="activity" insert="custom activity" desc="The SMU duration of the loading activity of the cycle."/>
        <!-- Truck SMU Activities -->
        <measure if="truck" name="travellingEmptySmuDuration" expr="cycle.activities.travellingEmptySmuDuration" unitType="duration" category="activity" insert="custom activity" desc="The SMU duration of the travelling empty activity time for truck cycles."/>
        <measure if="truck" name="queuingAtSourceSmuDuration" expr="cycle.activities.queuingAtSourceSmuDuration" unitType="duration" category="activity" insert="custom activity" desc="The SMU duration of the queuing at source activity time for truck cycles."/>
        <measure if="truck" name="spottingAtSourceSmuDuration" expr="cycle.activities.spottingAtSourceSmuDuration" unitType="duration" category="activity" insert="custom activity" desc="The SMU duration of the spotting at source activity time for truck cycles."/>
        <measure if="truck" name="travellingFullSmuDuration" expr="cycle.activities.travellingFullSmuDuration" unitType="duration" category="activity" insert="custom activity" desc="The SMU duration of the travelling full activity time for truck cycles."/>
        <measure if="truck" name="queuingAtSinkSmuDuration" expr="cycle.activities.queuingAtSinkSmuDuration" unitType="duration" category="activity" insert="custom activity" desc="The SMU duration of the queuing at sink activity time for truck cycles"/>
        <measure if="truck" name="spottingAtSinkSmuDuration" expr="cycle.activities.spottingAtSinkSmuDuration" unitType="duration" category="activity" insert="custom activity" desc="The SMU duration of the spotting at sink activity time for truck cycles"/>
        <measure if="truck" name="dumpingSmuDuration" expr="cycle.activities.dumpingSmuDuration" unitType="duration" category="activity" insert="custom activity" desc="The SMU duration of the dumping activity time for truck cycles."/>
        <measure if="truck" name="waitForLoadSmuDuration" expr="cycle.activities.waitForLoadSmuDuration" unitType="duration" category="activity"  insert="custom activity" desc="The SMU duration of the wait for load activity for truck cycles"/>
        <measure if="truck" name="waitForDumpSmuDuration" expr="cycle.activities.waitForDumpSmuDuration" unitType="duration" category="activity"  insert="custom activity" desc="The SMU duration of the wait for dump activity for truck cycles"/>
        <measure if="truck" name="queuingSmuDuration" expr="main.queuingAtSourceSmuDuration + main.queuingAtSinkSmuDuration" unitType="duration" category="activity" insert="custom activity" desc="The SMU duration of both queuing at sink and queuing at source added together"/>
        <measure if="truck" name="spottingSmuDuration" expr="main.spottingAtSourceSmuDuration + main.spottingAtSinkSmuDuration" unitType="duration" category="activity" insert="custom activity" desc="The SMU duration of both spotting at sink and spotting at source added together"/>
        <!-- Loading Tool SMU Activities -->
        <measure if="loader" name="hangTimeSmuDuration" expr="cycle.activities.hangTimeSmuDuration" unitType="duration" category="activity" insert="custom activity" desc='The SMU duration of the "Hang.Time" activity for loader cycles'/>
        <measure if="loader" name="waitForSpotSmuDuration" expr="cycle.activities.waitForSpotSmuDuration" unitType="duration" category="activity" insert="custom activity"  desc="The SMU duration of the wait for spot activity for loader cycles"/>
        <measure if="loader" name="lhdSmuDuration" expr='cycle.activities.getSmuDurationByActivity("LHD")' unitType="duration" category="activity" insert="custom activity" desc='The SMU duration of the "LHD" activity for loader cycles'/>
        <!-- Aquila Drill SMU Activities -->
        <measure if="drill" name="drillAddSteelSmuDuration" expr='cycle.activities.getSmuDurationByActivity("Add.Steel")' unitType="duration" category="activity" insert="custom activity"/>
        <measure if="drill" name="drillRemoveSteelSmuDuration" expr='cycle.activities.getSmuDurationByActivity("Remove.Steel")' unitType="duration" category="activity" insert="custom activity"/>
        <measure if="drill" name="drillPropelSmuDuration" expr='cycle.activities.getSmuDurationByActivity("Propel")' unitType="duration" category="activity" insert="custom activity"/>
        <measure if="drill" name="drillIdleSmuDuration" expr='cycle.activities.getSmuDurationByActivity("Idle")' unitType="duration" category="activity" insert="custom activity"/>
        <measure if="drill" name="drillLevelSmuDuration" expr='cycle.activities.getSmuDurationByActivity("Level")' unitType="duration" category="activity" insert="custom activity"/>
        <measure if="drill" name="drillDrillingSmuDuration" expr='cycle.activities.getSmuDurationByActivity("Drill")' unitType="duration" category="activity" insert="custom activity"/>
        <!-- All Equipment SMU Activities -->
        <measure name="notDeterminedSmuDuration" expr='cycle.activities.getSmuDurationByActivity("NOT_DETERMINED")' unitType="duration" category="activity" insert="custom activity" desc='The SMU duration of all activities of the type "NOT_DETERMINED"'/>

        <!-- Time Bucket SMU Measures based on Delay Category -->
        <measure name="operatingDelaySmuTime" expr='cycle.allDelays.getSmuDurationByCategory("Operating Delay")' unitType="duration" category="delay" insert="custom timeBucket"/>
        <measure name="nonOperatingDelaySmuTime" expr='cycle.allDelays.getSmuDurationByCategory("Non-Operating Delay")' unitType="duration" category="delay" insert="custom timeBucket"/>
        <measure name="standbySmuTime" expr='cycle.allDelays.getSmuDurationByCategory("Standby")' unitType="duration" category="delay" insert="custom timeBucket"/>
        <measure name="unscheduledDownSmuTime" expr='cycle.allDelays.getSmuDurationByCategory("Unscheduled Down")' unitType="duration" category="delay" insert="custom timeBucket"/>
        <measure name="scheduledDownSmuTime" expr='cycle.allDelays.getSmuDurationByCategory("Scheduled Down")' unitType="duration" category="delay" insert="custom timeBucket"/>
	
        <measure name="cycleSmuDuration" expr="KpiCalcUtil.calcSmuDuration(cycle.primaryMachine.entity, main.startTime, main.endTime, cycle.creationMode)" unitType="duration" category="time" insert="custom timeBucket" desc="The SMU duration of the cycle." interim="false"/>

        <!-- SMU Time measures Level 3 -->
        <measure if="truck" name="operatingSmuTime" expr="main.loadingSmuDuration + main.travellingEmptySmuDuration + main.queuingAtSourceSmuDuration + main.spottingAtSourceSmuDuration + main.travellingFullSmuDuration + main.queuingAtSinkSmuDuration + main.spottingAtSinkSmuDuration + main.dumpingSmuDuration + main.waitForLoadSmuDuration + main.waitForDumpSmuDuration + main.notDeterminedSmuDuration" unitType="duration" category="time" insert="custom time" desc="The SMU duration of all operating activities."/>
        <measure if="loader" name="operatingSmuTime" expr="main.loadingSmuDuration + main.hangTimeSmuDuration + main.lhdSmuDuration + main.waitForSpotSmuDuration + main.notDeterminedSmuDuration" unitType="duration" category="time" insert="custom time" desc="The SMU duration of all operating activities."/>
        <measure if="selfloader" name="operatingSmuTime" expr="main.cycleSmuDuration" unitType="duration" category="time" insert="custom time" desc="Just a default - should be overridden"/>
        <measure if="auxmobile" name="operatingSmuTime" expr="main.cycleSmuDuration" unitType="duration" category="time" insert="custom time" desc="Just a default - should be overridden"/>
        <measure if="drill" name="operatingSmuTime" expr="main.drillAddSteelSmuDuration + main.drillRemoveSteelSmuDuration + main.drillPropelSmuDuration + main.drillIdleSmuDuration + main.drillLevelSmuDuration + main.drillDrillingSmuDuration" unitType="duration" category="time" insert="custom time" desc="The SMU duration of all operating activities."/>/>

        <measure name="delaySmuTime" expr="main.operatingDelaySmuTime + main.nonOperatingDelaySmuTime" unitType="duration" category="delay" insert="custom time"/>

        <!-- SMU Time measures Level 2.5 -->
        <measure name="operHoursSmuSeconds" expr="main.operatingSmuTime + main.delaySmuTime" unitType="duration" category="time" insert="custom time"/>

        <!-- SMU Time measures Level 2 -->
        <measure name="availableSmuTime" expr="main.operatingSmuTime + main.standbySmuTime + main.delaySmuTime" unitType="duration" category="delay" insert="custom time"/>
        <measure name="downSmuTime" expr="main.scheduledDownSmuTime + main.unscheduledDownSmuTime" unitType="duration" category="delay" insert="custom time"/>

        <!-- SMU Time measures Level 1 -->
        <measure name="totalSmuTime" expr="main.availableSmuTime + main.downSmuTime" unitType="duration" category="time" insert="custom time"/>
    </fact>
</kpiSummaries>
