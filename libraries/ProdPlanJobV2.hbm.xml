<?xml version="1.0"?>
<!-- Copyright (c) 2021 Caterpillar -->

<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping schema="model" default-access="field" default-lazy="false">

    <!-- ****************************************************************************** -->
    <!-- PlanJob -->
    <!-- ****************************************************************************** -->
    <class name="minestar.planmanagement.domain.v2.ProdPlanJobV2" table="PROD_PLAN_JOB" schema="model">
        <meta attribute="index">
            name=PROD_PLAN_JOB_PLAN_OID
            unique=false
            columns=PLAN_OID
        </meta>
        <meta attribute="description">Store Plan Job details</meta>
        <meta attribute="view-include">false</meta>
        <meta attribute="view-ignore">true</meta>

        <id name="OID" type="java.lang.Long" column="OID">
            <generator class="com.mincom.env.base.persistence.IDGenerator"/>
        </id>
        
        <property name="planningSystemId" type="java.lang.String" column="PLANNING_SYSTEM_ID"/>
        <property name="planningSystemName" type="java.lang.String" column="PLANNING_SYSTEM_NAME"/>
        <property name="accountingCode" type="java.lang.String" column="ACCOUNTING_CODE"/>
        <property name="priority" column="TRUCKING_SATURATION_PRIORITY" not-null="true">
            <meta attribute="description">TruckingSaturationPriority</meta>
            <type name="org.hibernate.type.EnumType">
                <param name="enumClass">minestar.planmanagement.domain.v2.ProdPlanJobV2$TruckingSaturationPriority</param>
                <param name="type">12</param>
                <param name="useNamed">true</param>
            </type>
        </property>
        <property name="targetStart" type="TimestampType" column="TARGET_START_UTC">
            <meta attribute="utc-description">The target task start utc timestamp</meta>
            <meta attribute="description">Target task start time</meta>
            <meta attribute="view-localtime">true</meta>
        </property>
        <property name="targetEnd" type="TimestampType" column="TARGET_END_UTC">
            <meta attribute="utc-description">The target task end utc timestamp</meta>
            <meta attribute="description">Target task end time</meta>
            <meta attribute="view-localtime">true</meta>
        </property>
        <property name="importantSourceJob" type="java.lang.Boolean" column="IMPORTANT_SOURCE_JOB" not-null="true">
            <meta attribute="defaultValue">false</meta>
        </property>
        <property name="importantDumpJob" type="java.lang.Boolean" column="IMPORTANT_DUMP_JOB" not-null="true">
            <meta attribute="defaultValue">false</meta>
        </property>
        <property name="targetMass" column="TARGET_TOTAL_MASS">
            <meta attribute="unitType">mass</meta>
            <meta attribute="description">Target Mass</meta>
            <type name="quantity">
                <param name="unitType">mass</param>
                <param name="nullable">true</param>
            </type>
        </property>
        <property name="targetVolume" column="TARGET_TOTAL_VOLUME">
            <meta attribute="unitType">volume</meta>
            <meta attribute="description">Target Volume</meta>
            <type name="quantity">
                <param name="unitType">volume</param>
                <param name="nullable">true</param>
            </type>
        </property>
        <property name="actualMass" column="ACTUAL_MASS">
            <meta attribute="unitType">mass</meta>
            <meta attribute="description">Actual Mass</meta>
            <type name="quantity">
                <param name="unitType">mass</param>
                <param name="nullable">false</param>
            </type>
        </property>
        <property name="actualVolume" column="ACTUAL_VOLUME">
            <meta attribute="unitType">volume</meta>
            <meta attribute="description">Actual Volume</meta>
            <type name="quantity">
                <param name="unitType">volume</param>
                <param name="nullable">false</param>
            </type>
        </property>
        <property name="createdDate" type="TimestampType" column="CREATED_DATE_UTC">
            <meta attribute="utc-description">Created utc timestamp</meta>
            <meta attribute="description">The timestamp of created</meta>
            <meta attribute="view-localtime">true</meta>
        </property>
        <property name="lastUpdatedDate" type="TimestampType" column="UPDATED_DATE_UTC">
            <meta attribute="utc-description">Created utc timestamp</meta>
            <meta attribute="description">The timestamp of created</meta>
            <meta attribute="view-localtime">true</meta>
        </property>

        <set name="equipments" table="PROD_PLAN_JOB_EQUIPMENT" cascade="all" fetch="select" sort="natural">
            <meta attribute="description">Store Plan Job Equipment details</meta>
            <meta attribute="collection-primary-key">
                columns=JOB_OID,REFERENCE_ID
            </meta>
            <key column="JOB_OID" not-null="true" on-delete="cascade"/>
            <composite-element class="minestar.planmanagement.domain.v2.ProdPlanJobEquipment">
                <property name="referenceId" type="java.lang.String" column="REFERENCE_ID" not-null="true"/>
                <many-to-one name="ref"
                             column="EQUIPMENT_OID"
                             not-found="ignore"
                             class="minestar.pitlink.domain.machine.MachineReference">
                    <meta attribute="alias">loadingTool</meta>
                </many-to-one>
            </composite-element>
        </set>

        <set name="primarySources" table="PROD_PLAN_JOB_PRIMARY_SOURCE" cascade="all" fetch="select" sort="natural">
            <meta attribute="description">Store Plan Job Primary Source details</meta>
            <meta attribute="collection-primary-key">
                columns=JOB_OID,REFERENCE_ID
            </meta>
            <key column="JOB_OID" not-null="true" on-delete="cascade"/>
            <composite-element class="minestar.planmanagement.domain.v2.ProdPlanJobPrimarySource">
                <property name="referenceId" type="java.lang.String" column="REFERENCE_ID" not-null="true"/>
                <many-to-one name="ref"
                             column="SOURCE_OID"
                             not-found="ignore"
                             class="minestar.mine.domain.material.GradeBlockReference">
                    <meta attribute="alias">sourceBlock</meta>
                </many-to-one>
                <property name="targetMass" column="TARGET_MASS">
                    <meta attribute="unitType">mass</meta>
                    <meta attribute="description">Target Mass</meta>
                    <type name="quantity">
                        <param name="unitType">mass</param>
                        <param name="nullable">true</param>
                    </type>
                </property>
                <property name="targetVolume" column="TARGET_VOLUME">
                    <meta attribute="unitType">volume</meta>
                    <meta attribute="description">Target Volume</meta>
                    <type name="quantity">
                        <param name="unitType">volume</param>
                        <param name="nullable">true</param>
                    </type>
                </property>

                <property name="comments" column="COMMENTS" length="65536"/>
            </composite-element>
        </set>

        <set name="alternateSources" table="PROD_PLAN_JOB_ALTERNATE_SOURCE" cascade="all" fetch="select" sort="natural">
            <meta attribute="description">Store Plan Job Alternate Source details</meta>
            <meta attribute="collection-primary-key">
                columns=JOB_OID,REFERENCE_ID
            </meta>
            <key column="JOB_OID" not-null="true" on-delete="cascade"/>
            <composite-element class="minestar.planmanagement.domain.v2.ProdPlanJobAlternateSource">
                <property name="referenceId" type="java.lang.String" column="REFERENCE_ID" not-null="true"/>
                <many-to-one name="ref"
                             column="SOURCE_OID"
                             not-found="ignore"
                             class="minestar.mine.domain.material.GradeBlockReference">
                    <meta attribute="alias">sourceBlock</meta>
                </many-to-one>
                <property name="maxMass" column="MAX_MASS">
                    <meta attribute="unitType">mass</meta>
                    <meta attribute="description">Max Mass</meta>
                    <type name="quantity">
                        <param name="unitType">mass</param>
                        <param name="nullable">true</param>
                    </type>
                </property>
                <property name="maxVolume" column="MAX_VOLUME">
                    <meta attribute="unitType">volume</meta>
                    <meta attribute="description">Max Volume</meta>
                    <type name="quantity">
                        <param name="unitType">volume</param>
                        <param name="nullable">true</param>
                    </type>
                </property>

                <property name="comments" column="COMMENTS" length="65536"/>
            </composite-element>
        </set>

        <set name="primaryDumps" table="PROD_PLAN_JOB_PRIMARY_DUMP" cascade="all" fetch="select" sort="natural">
            <meta attribute="description">Store Plan Job Primary Dump details</meta>
            <meta attribute="collection-primary-key">
                columns=JOB_OID,REFERENCE_ID
            </meta>
            <key column="JOB_OID" not-null="true" on-delete="cascade"/>
            <composite-element class="minestar.planmanagement.domain.v2.ProdPlanJobPrimaryDump">
                <property name="referenceId" type="java.lang.String" column="REFERENCE_ID" not-null="true"/>
                <many-to-one name="ref"
                             column="DUMP_OID"
                             not-found="ignore"
                             class="minestar.pitlink.domain.machine.MachineReference">
                    <meta attribute="alias">processor</meta>
                </many-to-one>
                <property name="blendReferenceId" type="java.lang.String" column="BLEND_REFERENCE_ID"/>
                <many-to-one name="blendRef"
                             column="DUMP_BLEND_OID"
                             not-found="ignore"
                             class="minestar.mine.domain.material.BlendReference">
                    <meta attribute="alias">blend</meta>
                </many-to-one>
                <property name="targetMass" column="TARGET_MASS">
                    <meta attribute="unitType">mass</meta>
                    <meta attribute="description">Target Mass</meta>
                    <type name="quantity">
                        <param name="unitType">mass</param>
                        <param name="nullable">true</param>
                    </type>
                </property>
                <property name="targetVolume" column="TARGET_VOLUME">
                    <meta attribute="unitType">volume</meta>
                    <meta attribute="description">Target Volume</meta>
                    <type name="quantity">
                        <param name="unitType">volume</param>
                        <param name="nullable">true</param>
                    </type>
                </property>

                <property name="comments" column="COMMENTS" length="65536"/>
            </composite-element>
        </set>

        <set name="alternateDumps" table="PROD_PLAN_JOB_ALTERNATE_DUMP" cascade="all" fetch="select" sort="natural">
            <meta attribute="description">Store Plan Job Alternate Dump details</meta>
            <meta attribute="collection-primary-key">
                columns=JOB_OID,REFERENCE_ID
            </meta>
            <key column="JOB_OID" not-null="true" on-delete="cascade"/>
            <composite-element class="minestar.planmanagement.domain.v2.ProdPlanJobAlternateDump">
                <property name="referenceId" type="java.lang.String" column="REFERENCE_ID" not-null="true"/>
                <many-to-one name="ref"
                             column="DUMP_OID"
                             not-found="ignore"
                             class="minestar.pitlink.domain.machine.MachineReference">
                    <meta attribute="alias">processor</meta>
                </many-to-one>
                <property name="blendReferenceId" type="java.lang.String" column="BLEND_REFERENCE_ID"/>
                <many-to-one name="blendRef"
                             column="DUMP_BLEND_OID"
                             not-found="ignore"
                             class="minestar.mine.domain.material.BlendReference">
                    <meta attribute="alias">blend</meta>
                </many-to-one>
                <property name="maxMass" column="MAX_MASS">
                    <meta attribute="unitType">mass</meta>
                    <meta attribute="description">Max Mass</meta>
                    <type name="quantity">
                        <param name="unitType">mass</param>
                        <param name="nullable">true</param>
                    </type>
                </property>
                <property name="maxVolume" column="MAX_VOLUME">
                    <meta attribute="unitType">volume</meta>
                    <meta attribute="description">Max Volume</meta>
                    <type name="quantity">
                        <param name="unitType">volume</param>
                        <param name="nullable">true</param>
                    </type>
                </property>

                <property name="comments" column="COMMENTS" length="65536"/>
            </composite-element>
        </set>

        <property name="comments" column="COMMENTS" length="65536"/>
        
        <property name="notes" column="NOTES" length="65536"/>

    </class>

    <!-- A lightweight reference to a Job -->
    <class name="minestar.planmanagement.domain.v2.ProdPlanJobReferenceV2" table="PROD_PLAN_JOB" mutable="false" lazy="false">

        <meta attribute="alias" inherit="false">PROD_PLAN_JOB_REFERENCE</meta>
        <meta attribute="view-create-order">1</meta>

        <id name="OID" type="long" column="OID"/>
    </class>

</hibernate-mapping>
