<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping schema="historical">

    <class
            name="minestar.production.domain.event.FluidAndSmuRecord"
            table="FLUID_SMU_RECORD"
            lazy="false"
            >
        <meta attribute="table">
            tablespace=MW_OBJ
        </meta>
        <meta attribute="primary-key">
            tablespace=MW_IDXOBJ
        </meta>

        <meta attribute="index">
            name=FLUID_RECORD_UNIQ
            unique=true
            columns=MACHINE_OID, TIMESTAMP_UTC
            tablespace=MW_IDXENT
        </meta>
        <meta attribute="description">The fluid and SMU record</meta>

        <id
                name="OID"
                type="java.lang.Long"
                column="OID"
                >
            <generator class="com.mincom.env.base.persistence.IDGenerator"/>
        </id>

        <version name="version" access="field">
              <meta attribute="description">The version field</meta>
        </version>

        <property
                name="machineOID"
                type="java.lang.Long"
                column="MACHINE_OID"
                not-null="true"
                >
            <meta attribute="manyToOne">minestar.pitlink.domain.machine.MachineImpl</meta>
        </property>

        <property
            name="timestamp"
            type="TimestampType"
        >
            <meta attribute="timestamp">true</meta>
            <meta attribute="view-localtime">true</meta>
            <meta attribute="utc-description">The utc timestamp.</meta>
            <meta attribute="description">The timestamp</meta>
            <column name="TIMESTAMP_UTC" not-null="true" default="01-JAN-1970"/>
        </property>

        <property
                name="odometer"
                column="ODOMETER"
                >
            <meta attribute="unitType">odometer</meta>
            <type name="quantity">
                <param name="unitType">odometer</param>
                <param name="nullable">true</param>
            </type>
        </property>
        <property
            name="smu"
            column="SMU"
        >
            <meta attribute="unitType">service meter hours</meta>
            <type name="quantity">
                <param name="unitType">service meter hours</param>
                <param name="nullable">true</param>
            </type>
        </property>
        <property
            name="workOrderRef"
            column="WORKORDER_REF"
            type="java.lang.String"
            length="254"
            not-null="false">
            <meta attribute="description">The work order reference to be attached to this fluid and SMU record</meta>
        </property>
        <property
                name="allowSmuReset"
                column="ALLOW_SMU_RESET"
                type="java.lang.Boolean"
                not-null="true"
        >
            <meta attribute="defaultValue">false</meta>
            <meta attribute="description">True if this record contains an authorised SMU hours reset</meta>
        </property>
        <property
                name="fuelAttendantOID"
                type="java.lang.Long"
                column="FUELATTENDANT_OID"
                >
            <meta attribute="manyToOne">minestar.machinetracking.domain.PersonImpl</meta>
        </property>
        <property
                name="operatorOID"
                type="java.lang.Long"
                column="OPERATOR_OID"
                >
            <meta attribute="manyToOne">minestar.machinetracking.domain.PersonImpl</meta>
        </property>
        <property
                name="dataSource"
                type="java.lang.Integer"
                column="DATASOURCE"
                >
            <meta attribute="choices" inherit="false">choice:smuDataSource</meta>
        </property>
        <map name="fluids"
             lazy = "false"
             table="FLUID_RECORD_FLUIDENTRY"
                >
            <meta attribute="collection-table">
                tablespace=MW_OBJ
            </meta>
            <meta attribute="collection-primary-key">
                tablespace=MW_IDXOBJ
            </meta>
            <meta attribute="index-view-nested">true</meta>
            <meta attribute="index-alias">fuelAndLubeType</meta>
            <meta attribute="index-manyToOne">minestar.production.domain.fuel.FuelAndLubeType</meta>
            <meta attribute="element-universe-type-measure">true</meta>
            <meta attribute="element-unitType">unitless</meta>
            <meta attribute="element-quantity">unitType,fieldInputUnit</meta>
            <meta attribute="description">The associated fluid and lube types</meta>
            <key column="RECORD_OID" not-null="true"/>
            <index type="java.lang.Long" column="FUEL_TYPE_OID"/>
            <element type="java.lang.Double" column="AMOUNT" not-null="true"/>
        </map>
    </class>
</hibernate-mapping>
