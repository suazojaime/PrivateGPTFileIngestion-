<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd http://www.liquibase.org/xml/ns/dbchangelog-ext /dbchangelog-ext-3.1.xsd">
    <changeSet id="9faad99b-17b1-4a5c-9871-784b879efd64" author="MineStar" failOnError="false">
        <preConditions onFailMessage="Ignored CreateIndex for CHANNEL_DISPLAY_IDX to table CHANNEL_DISPLAY as (1) table does not exist, or (2) index already exists." onFail="MARK_RAN">
            <tableExists tableName="CHANNEL_DISPLAY"/>
            <not>
                <indexExists indexName="CHANNEL_DISPLAY_IDX" tableName="CHANNEL_DISPLAY"/>
            </not>
        </preConditions>
        <comment>HLT-802: CreateIndex CHANNEL_DISPLAY_IDX on CHANNEL_DISPLAY (CHANNELVALUE,DISPLAYCODE)</comment>
        <createIndex unique="false" tablespace="MW_IDXENT" indexName="CHANNEL_DISPLAY_IDX" tableName="CHANNEL_DISPLAY">
            <column name="CHANNELVALUE"/>
            <column name="DISPLAYCODE"/>
        </createIndex>
        <modifySql dbms="mssql,h2,postgresql">
            <regExpReplace replace="( USING INDEX)? (ON|TABLESPACE) MW_[A-Z]+" with=""/>
        </modifySql>
    </changeSet>

    <!-- Comment out as it is already handled by db/changelog/4_4/model/updates/ahs-4521-add-traction-level-to-derate.xml. -->
    <!--<changeSet id="798b65ad-2029-4f5f-93d2-71cfba0a313e" author="MineStar" failOnError="false">-->
        <!--<preConditions onFailMessage="Ignored DropColumn for ENABLE_TRACTION of table DERATE as column does not exist." onFail="MARK_RAN">-->
            <!--<columnExists tableName="DERATE" columnName="ENABLE_TRACTION"/>-->
        <!--</preConditions>-->
        <!--<comment>HLT-802: DropColumn DERATE.ENABLE_TRACTION</comment>-->
        <!--<dropColumn columnName="ENABLE_TRACTION" tableName="DERATE"/>-->
        <!--<rollback>-->
            <!--<addColumn tableName="DERATE">-->
                <!--<column name="ENABLE_TRACTION" type="BOOLEAN" defaultValueBoolean="false">-->
                    <!--<constraints nullable="false"/>-->
                <!--</column>-->
            <!--</addColumn>-->
        <!--</rollback>-->
    <!--</changeSet>-->
    <changeSet id="11b427f0-2324-474f-86d9-c12006648ccb" author="MineStar" failOnError="false">
        <preConditions onFailMessage="Ignored CreateIndex for MEASURE_PROTOCOL_DTLS_IDX to table MEASURE_DEF as (1) table does not exist, or (2) index already exists." onFail="MARK_RAN">
            <tableExists tableName="MEASURE_DEF"/>
            <not>
                <indexExists indexName="MEASURE_PROTOCOL_DTLS_IDX" tableName="MEASURE_DEF"/>
            </not>
        </preConditions>
        <comment>HLT-802: CreateIndex MEASURE_PROTOCOL_DTLS_IDX on MEASURE_DEF (PROTOCOL_ID,PROTOCOL_SUBID,PROTOCOL_DISPLAYCODE)</comment>
        <createIndex unique="false" tablespace="MW_IDXENT" indexName="MEASURE_PROTOCOL_DTLS_IDX" tableName="MEASURE_DEF">
            <column name="PROTOCOL_ID"/>
            <column name="PROTOCOL_SUBID"/>
            <column name="PROTOCOL_DISPLAYCODE"/>
        </createIndex>
        <modifySql dbms="mssql,h2,postgresql">
            <regExpReplace replace="( USING INDEX)? (ON|TABLESPACE) MW_[A-Z]+" with=""/>
        </modifySql>
    </changeSet>
</databaseChangeLog>
