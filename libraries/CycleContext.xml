<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <!-- cycle service can occasionally deadlock on startup unless it waits for the OnbaordHardwareService-->
    <bean id="cycleServiceImpl" class="minestar.production.service.cycle.CycleServiceImpl" init-method="init" depends-on="onboardHardwareServiceImpl">
        <property name="cycleDao">
            <bean class="minestar.production.persistence.cycle.CycleDaoImpl">
                <property name="sessionFactory" ref="minestarSessionFactory"/>
            </bean>
        </property>
        <property name="notification" ref="notification"/>
        <property name="hibernateEventListener" ref="hibernateEventListener"/>
        <property name="txManager" ref="minestarTransactionManager"/>
        <property name="cycleActivityArchiveService" ref="cycleActivityArchiveServiceImpl"/>
    </bean>

    <bean id="registerCycleServiceImpl" parent="registrationInstance">
        <constructor-arg value="Cycle Service"/>
        <constructor-arg value="minestar.production.service.cycle.CycleService"/>
        <constructor-arg ref="cycleServiceImpl"/>
    </bean>

    <bean id="cycleSynchronizerServiceImpl" class="minestar.production.service.cycle.CycleSynchronizerServiceImpl">
        <property name="cycleService" ref="cycleServiceImpl"/>
    </bean>

    <bean id="registerCycleSynchronizerServiceImpl" parent="registrationInstance">
        <constructor-arg value="Cycle Synchronizer Service"/>
        <constructor-arg value="minestar.production.service.cycle.CycleSynchronizerService"/>
        <constructor-arg ref="cycleSynchronizerServiceImpl"/>
    </bean>

    <bean id="cycleActivityArchiveServiceImpl" class="minestar.production.service.cycle.activities.io.CycleActivityArchiveServiceImpl" init-method="init">
        <property name="jsonFileService" ref="jsonFileServiceImpl"/>
        <property name="cycleService" ref="cycleServiceImpl"/>
    </bean>

</beans>

