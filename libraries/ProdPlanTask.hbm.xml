<?xml version="1.0"?>
<!-- Copyright (c) 2021 Caterpillar -->

<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping schema="model" default-access="field" default-lazy="false">

    <class name="minestar.planmanagement.persistence.v2.ProdPlanTaskDO" table="PROD_PLAN_TASK">
        <meta attribute="description">Stores production planning task details</meta>

        <id name="OID" type="long" column="TASK_OID">
            <meta attribute="description">Internal OID that uniquely identifies a task</meta>
            <generator class="com.mincom.env.base.persistence.IDGenerator"/>
        </id>

        <version name="version">
            <meta attribute="defaultValue">0</meta>
            <meta attribute="description">The version number for optimistic locking</meta>
            <column name="VERSION" default="0" not-null="true"/>
        </version>

        <property name="uuid" type="java.util.UUID" column="TASK_UUID" not-null="true">
            <meta attribute="description">UUID that uniquely identifies a task</meta>
        </property>

        <property name="createdTime" type="minestar.platform.persistence.HibernateUTCInstantType" column="CREATED_TIME_UTC" not-null="true">
            <meta attribute="utc-description">The creation timestamp of the task</meta>
            <meta attribute="description">Task creation timestamp</meta>
            <meta attribute="view-localtime">true</meta>
        </property>

        <property name="lastUpdatedTime" type="minestar.platform.persistence.HibernateUTCInstantType" column="UPDATED_TIME_UTC" not-null="true">
            <meta attribute="utc-description">The update timestamp of the task</meta>
            <meta attribute="description">Task updated timestamp</meta>
            <meta attribute="view-localtime">true</meta>
        </property>

        <property name="targetStartTime" type="minestar.platform.persistence.HibernateUTCInstantType" column="TARGET_START_TIME_UTC">
            <meta attribute="utc-description">The planned start time of the task</meta>
            <meta attribute="description">The planned start time of the task</meta>
            <meta attribute="view-localtime">true</meta>
        </property>

        <property name="targetEndTime" type="minestar.platform.persistence.HibernateUTCInstantType" column="TARGET_END_TIME_UTC">
            <meta attribute="utc-description">The planned end time of the task</meta>
            <meta attribute="description">The planned end time of the task</meta>
            <meta attribute="view-localtime">true</meta>
        </property>

        <property name="actualStartTime" type="minestar.platform.persistence.HibernateUTCInstantType" column="ACTUAL_START_TIME_UTC">
            <meta attribute="utc-description">The actual start time of the task when status changed to AVAILABLE</meta>
            <meta attribute="description">The actual start time of the task when status changed to AVAILABLE</meta>
            <meta attribute="view-localtime">true</meta>
        </property>

        <property name="actualEndTime" type="minestar.platform.persistence.HibernateUTCInstantType" column="ACTUAL_END_TIME_UTC">
            <meta attribute="utc-description">The actual end time of the task when status changed to CLOSED</meta>
            <meta attribute="description">The actual end time of the task when status changed to CLOSED</meta>
            <meta attribute="view-localtime">true</meta>
        </property>

        <property name="taskType" type="minestar.planmanagement.persistence.v2.ProdPlanTaskTypeEnumUserType" length="32"
                  column="TASK_TYPE" not-null="true">
            <meta attribute="description">The type of task</meta>
        </property>

        <property name="taskStatus" type="minestar.planmanagement.persistence.v2.ProdPlanTaskStatusEnumUserType"
                  length="32" column="TASK_STATUS" not-null="true">
            <meta attribute="description">The status of task</meta>
        </property>

        <property name="taskContent" type="string" length="65536" column="TASK_CONTENT" not-null="true">
            <meta attribute="description">The JSON encoding of the task</meta>
        </property>

    </class>

    <!-- A lightweight reference to a ProdPlanTask -->
    <class name="minestar.planmanagement.domain.v2.ProdPlanTaskReference"
           table="PROD_PLAN_TASK" schema="model"
           mutable="false"
           lazy="false">

        <meta attribute="alias" inherit="false">PROD_PLAN_TASK_REFERENCE</meta>
        <meta attribute="description">A minimal reference to a task.</meta>
        <meta attribute="view-create-order">1</meta>

        <cache usage="read-only" region="model"/>

        <id name="OID" type="long" column="TASK_OID"/>
    </class>
    
</hibernate-mapping>
