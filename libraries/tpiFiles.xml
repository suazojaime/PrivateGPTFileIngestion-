<?xml version="1.0" standalone="no"?>
<!DOCTYPE Messages SYSTEM "tpiFiles.dtd">

<!-- $Id: tpifiles.xml,v 1.1 2005-08-08 00:25:29 darrylc Exp $ -->
<!-- 
    $Log: not supported by cvs2svn $

-->

<Messages>

    <Type name="Location">
        <Field name="flags" format="BitMask" length="8">
            <BitField bit="0" name="timestampIncluded"/>
            <BitField bit="1" name="accuracyIncluded"/>
            <BitField bit="2" name="positionIncluded"/>
            <BitField bit="3" name="positionInLatitudeAndLongitude"/>
            <BitField bit="4" name="stateIncluded"/>
            <BitField bit="5" name="headingIncluded"/>
            <BitField bit="6" name="filteredElevation"/>
            <BitField bit="7" name="smuOrErrorcodeIncluded"/>
        </Field>
        <Field name="timestamp" format="UTC" indicator="Flags" indicatorBit="0"/>
        <Field name="accuracy" format="BitMask" length="8" indicator="Flags" indicatorBit="1">
            <BitField bit="0" name="noFix" trueInterpretation="NoFixWasAvailable" falseInterpretation="FixWasAvailable"/>
            <BitField bit="1" name="corrected" trueInterpretation="FixWasCorrectedWithRTCM" falseInterpretation="FixWasAutonomous"/>
            <BitField bit="2" name="2dFix" trueInterpretation="2DFix" falseInterpretation="3DFix"/>
            <BitField bit="3" name="usedEnteredAltitude" trueInterpretation="UsedEnteredAltitude" falseInterpretation="LastCalculatedAltitute"/>
            <BitField bit="4" name="filtered" trueInterpretation="PositionOrAltitudeFilterOn" falseInterpretation="Unfiltered"/>
        </Field>
        <Field name="position" format="Block" indicator="Flags" indicatorBit="2">
            <Field name="x" format="I32" scale="0.01" units="metre" unitType="length" indicator="Flags" indicatorBit="3" invert="true"/>
            <Field name="y" format="I32" scale="0.01" units="metre" unitType="length" indicator="Flags" indicatorBit="3" invert="true"/>
            <Field name="z" format="I32" scale="0.01" units="metre" unitType="length" indicator="Flags" indicatorBit="3" invert="true"/>
            <Field name="latitude" format="F64" indicator="Flags" indicatorBit="3"/>
            <Field name="longitude" format="F64" indicator="Flags" indicatorBit="3"/>
            <Field name="elevation" format="F64" indicator="Flags" indicatorBit="3"/>
        </Field>
        <Field name="heading" format="I8" scale="0.025" indicator="Flags" indicatorBit="5" units="radian" unitType="plane angle"/>
        <Field name="smuBlock" format="Block" indicator="Flags" indicatorBit="7">
            <Field name="smu" format="U32" indicator="Flags" indicatorBit="3" invert="true" units="second" unitType="service meter hours"/>
        </Field>
        <Field name="state" format="Enum" length="8" indicator="Flags" indicatorBit="4">
            <Enum value="0" name="state0"/>
            <Enum value="1" name="state1"/>
            <Enum value="2" name="state2"/>
            <Enum value="3" name="state3"/>
            <Enum value="4" name="state4"/>
            <Enum value="5" name="state5"/>
            <Enum value="6" name="state6"/>
            <Enum value="7" name="state8"/>
            <Enum value="8" name="state9"/>
        </Field>
        <Field name="stateflags" format="Enum" length="8" indicator="Flags" indicatorBit="4">
            <Enum value="0" name="stateflags0"/>
            <Enum value="1" name="stateflags1"/>
            <Enum value="2" name="stateflags2"/>
            <Enum value="3" name="stateflags3"/>
            <Enum value="4" name="stateflags4"/>
            <Enum value="5" name="stateflags5"/>
            <Enum value="6" name="stateflags6"/>
            <Enum value="7" name="stateflags7"/>
            <Enum value="8" name="stateflags8"/>
            <Enum value="9" name="stateflags9"/>
            <Enum value="10" name="stateflags10"/>
            <Enum value="11" name="stateflags11"/>
            <Enum value="12" name="stateflags12"/>
            <Enum value="13" name="stateflags13"/>
            <Enum value="14" name="stateflags14"/>
            <Enum value="15" name="stateflags15"/>
            <Enum value="16" name="stateflags16"/>
        </Field>
        <Field name="errorcodeBlock" format="Block" indicator="Flags" indicatorBit="3">
            <Field name="errorcode" format="BitMask" length="8" indicator="Flags" indicatorBit="7">
                <BitField bit="0" name="unknown"/>
                <BitField bit="1" name="unknown"/>
                <BitField bit="2" name="unknown"/>
                <BitField bit="3" name="unknown"/>
                <BitField bit="4" name="unknown"/>
                <BitField bit="5" name="unknown"/>
                <BitField bit="6" name="NoPosition"/>
                <BitField bit="7" name="NoAntenna"/>
            </Field>
        </Field>
    </Type>

    <Message name="tpiFile" id="0">
        <Field name="fileType" format="U8"/>
        <Field name="samples" format="Block" count="...">
            <Field name="sample" format="Block">
                <Field name="timestamp" format="UTC"/>
                <Field name="indicators0" format="BitMask" length="8">
                    <BitField name="analogLogIncluded" bit="0"/>
                    <BitField name="longAnalogLogIncluded" bit="1"/>
                    <BitField name="digitalLogIncluded" bit="2"/>
                    <BitField name="locationIncluded" bit="3"/>
                </Field>
                <Field name="tpiInterfaceType" format="Enum" length="16">
                    <Enum value="0" name="Invalid"/>
                    <Enum value="1" name="MMSI_PLM"/>
                    <Enum value="2" name="MMSI_Cense"/>
                    <Enum value="3" name="MMSI_TCI"/>
                    <Enum value="4" name="MMSI_Statex"/>
                    <Enum value="5" name="VIMS"/>
                    <Enum value="6" name="EAM"/>
                    <Enum value="7" name="TPMS"/>
                </Field>
                <Field name="numberOfAnalogChannels" format="U8" indicatorBit="0"/>
                <Field name="analogChannels" format="Block" count="numberOfAnalogChannels" indicatorBit="0">
                    <Field name="analogChannel" format="Block">
                        <Field name="spn" format="U24"/>
                        <Field name="data" format="U16"/>
                    </Field>
                </Field>
                <Field name="numberOfLongAnalogChannels" format="U8" indicatorBit="1"/>
                <Field name="longAnalogChannels" format="Block" count="numberOfLongAnalogChannels" indicatorBit="1">
                    <Field name="analogChannel" format="Block">
                        <Field name="spn" format="U24"/>
                        <Field name="data" format="U32"/>
                    </Field>
                </Field>
                <Field name="numberOfDigitalChannels" format="U8" indicatorBit="2"/>
                <Field name="digitalChannels" format="Block" count="numberOfDigitalChannels" indicatorBit="2">
                    <Field name="digitalChannel" format="Block">
                        <Field name="spnAndData" format="U24"/>
                    </Field>
                </Field>
                <Field name="location" format="Location" indicatorBit="3"/>
            </Field>
        </Field>
    </Message>

</Messages>
