<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping default-access="field" schema="model">

    <class name="minestar.mine.domain.minemodel.underground.orepass.OrePassImpl"
           table="ORE_PASS"
           dynamic-update="true" lazy="false">

        <meta attribute="alias" inherit="false">OREPASS</meta>
        <meta attribute="view-master">true</meta>
        <meta attribute="description">
            A location in the extraction level of a block-cave mine where load-haul-dump (LHD) trucks dump their loads
            into.
        </meta>
        <meta attribute="table">
            tablespace=MW_ENT
        </meta>
        <meta attribute="primary-key">
            tablespace=MW_IDXENT
        </meta>
        <meta attribute="index">
            name=OREPASS_ID
            unique=true
            columns=ID
            tablespace=MW_IDXENT
        </meta>
        <meta attribute="index">
            name=OREPASS_NAME
            unique=true
            columns=NAME
            tablespace=MW_IDXENT
        </meta>

        <cache usage="read-write" region="model"/>

        <id name="OID"
            type="java.lang.Long"
            column="OREPASS_OID">
            <generator class="com.mincom.env.base.persistence.IDGenerator"/>
        </id>

        <property name="name"
                  type="java.lang.String"
                  column="NAME"
                  length="254">
            <meta attribute="description">The unique, user-entered identifier for this ore pass.</meta>
        </property>

        <property name="id"
                  type="java.lang.Integer"
                  column="ID"
                  not-null="true">
            <meta attribute="description">The unique, system-assigned identifier for this ore pass.</meta>
            <meta attribute="universe-type-measure">false</meta>
            <meta attribute="export-marshall" inherit="false">false</meta>
        </property>

        <property name="active"
                  type="java.lang.Boolean"
                  column="IS_ACTIVE"
                  not-null="true">
            <meta attribute="defaultValue">true</meta>
            <meta attribute="description">
                Whether this ore pass is active or archived.
                (This flag is '1' if it is active and '0' if archived.)
            </meta>
        </property>

        <property name="modelUpdateVersion"
                  type="java.lang.Long"
                  column="MODEL_UPDATE_VERSION">
            <meta attribute="description">The is a copy of the system wide version number.</meta>
            <meta attribute="universe-type-measure">false</meta>
            <meta attribute="export-marshall" inherit="false">false</meta>
        </property>

        <many-to-one name="operatingStatus"
                     class="minestar.mine.domain.minemodel.underground.operatingstatus.OrePassOperatingStatusImpl"
                     column="OPERATING_STATUS"
                     lazy="false">
            <meta attribute="description">
                A reference to the operating status (MSMODEL.OPERATING_STATUS) that describes the current operating
                conditions of this ore pass.
            </meta>
        </many-to-one>

        <property name="position"
                  type="XYZCoordinate">
            <meta attribute="description">
                (DEPRECATED) This field is no longer used. It used to store the XYZ coordinate of the ore pass's
                position, which is now stored in the bounding waypoint of its associated location.
            </meta>
            <column name="POSITION_POINT_X"/>
            <column name="POSITION_POINT_Y"/>
            <column name="POSITION_POINT_Z"/>
        </property>

        <many-to-one name="associatedLocation"
                     class="minestar.mine.domain.minemodel.LocationReference"
                     column="LOCATION"
                     lazy="false">
            <meta attribute="alias" inherit="false">ASSOCIATEDLOCATION</meta>
            <meta attribute="description">
                A reference to the location (MSMODEL.LOCATION) that is associated with this ore pass.
                An LHD cycle has as its sink a reference to a location, rather than a reference to an ore pass.
                This association is used to identify which ore pass that the LHD dumped its load into in the cycle.
                Additionally, the ore pass's position and boundary polygon are stored in the bounding waypoint of
                its associated location.
            </meta>
        </many-to-one>

        <many-to-one name="areaRef"
                     class="minestar.mine.domain.minemodel.underground.area.UndergroundAreaReference"
                     column="AREA_OID"
                     lazy="false">
            <meta attribute="description">
                A reference to the underground area (MSMODEL.UNDERGROUND_AREA) that this ore pass is located at.
            </meta>
        </many-to-one>

        <many-to-one name="chuteRef"
                     class="minestar.pitlink.domain.machine.UndergroundChuteReference"
                     column="CHUTE"
                     lazy="false">
            <meta attribute="description">
                A reference to the chute (MSMODEL.UG_CHUTE) in the haulage level that this ore pass is linked to.
            </meta>
        </many-to-one>


        <many-to-one name="drawPointReference"
                     class="minestar.mine.domain.minemodel.underground.drawpoint.DrawPointReference"
                     column="DRAW_POINT"
                     lazy="false">
            <meta attribute="description">
                A reference to the draw point that this ore pass is connected to.
            </meta>
        </many-to-one>

        <property name="externalRef" type="java.lang.String" column="EXTERNALREF" length="254">
            <meta attribute="description">The external system reference of this ore pass</meta>
        </property>

        <property name="externalDesc" type="java.lang.String" column="EXTERNALDESC" length="254">
            <meta attribute="description">The External System Description</meta>
        </property>


    </class>

    <!-- A lightweight reference to an Ore Pass -->
    <class name="minestar.mine.domain.minemodel.underground.orepass.OrePassReference"
           table="ORE_PASS"
           mutable="false"
           lazy="false">

        <meta attribute="alias" inherit="false">OREPASSREFERENCE</meta>
        <meta attribute="description">A minimal reference to an ore pass.</meta>
        <meta attribute="lookupExpr" inherit="false">name</meta>
        <meta attribute="viewproperty-name" inherit="false">
            type=string
            description=The name for the ore pass.
            expression=lookupResource.orepass.name.query
        </meta>
        <meta attribute="view-create-order">1</meta>

        <cache usage="read-only" region="model"/>

        <id name="OID"
            type="long"
            column="OREPASS_OID"
            access="field"/>

        <property name="name"
                  type="java.lang.String"
                  column="NAME"
                  access="field"/>
    </class>

</hibernate-mapping>
