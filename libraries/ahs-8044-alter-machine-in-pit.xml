<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd http://www.liquibase.org/xml/ns/dbchangelog-ext /dbchangelog-ext-3.1.xsd">

    <changeSet id="da9521ec-714a-41c9-b7d6-ceaf030e5f39" author="MineStar" failOnError="false">
        <preConditions
                onFailMessage="Ignored AddNotNullConstraint for MACHINE_IN_PIT.STATUS as column does not exist or is already not-nullable"
                onFail="MARK_RAN">
            <ext:columnIsNullable tableName="MACHINE_IN_PIT" columnName="STATUS"/>
        </preConditions>
        <comment>AHS-8044: AddNotNullConstraint to MACHINE_IN_PIT.STATUS</comment>
        <sql>UPDATE MACHINE_IN_PIT SET STATUS = 0 WHERE STATUS IS NULL</sql>
        <addNotNullConstraint columnName="STATUS" columnDataType="TINYINT" tableName="MACHINE_IN_PIT"/>
        <rollback>
            <dropNotNullConstraint tableName="MACHINE_IN_PIT" columnName="STATUS" columnDataType="TINYINT"/>
        </rollback>
    </changeSet>

    <changeSet id="2d2587f4-4a06-4bf4-a84f-637ea42473ee" author="MineStar" failOnError="false">
        <preConditions
                onFailMessage="Ignored AddNotNullConstraint for MACHINE_IN_PIT.MACHINE_SHUTDOWN as column does not exist or is already not-nullable"
                onFail="MARK_RAN">
            <ext:columnIsNullable tableName="MACHINE_IN_PIT" columnName="MACHINE_SHUTDOWN"/>
        </preConditions>
        <comment>AHS-8044: AddNotNullConstraint to MACHINE_IN_PIT.MACHINE_SHUTDOWN</comment>
        <sql>UPDATE MACHINE_IN_PIT SET MACHINE_SHUTDOWN = 0 WHERE MACHINE_SHUTDOWN IS NULL</sql>
        <addNotNullConstraint columnName="MACHINE_SHUTDOWN" columnDataType="BOOLEAN" tableName="MACHINE_IN_PIT"/>
        <rollback>
            <dropNotNullConstraint tableName="MACHINE_IN_PIT" columnName="MACHINE_SHUTDOWN" columnDataType="BOOLEAN"/>
        </rollback>
    </changeSet>

    <changeSet id="6f6fb8d8-a53f-4a23-a746-64628f4b463a" author="MineStar" failOnError="false">
        <preConditions
                onFailMessage="Ignored AddNotNullConstraint for MACHINE_IN_PIT.NOT_IN_USE as column does not exist or is already not-nullable"
                onFail="MARK_RAN">
            <ext:columnIsNullable tableName="MACHINE_IN_PIT" columnName="NOT_IN_USE"/>
        </preConditions>
        <comment>AHS-8044: AddNotNullConstraint to MACHINE_IN_PIT.NOT_IN_USE</comment>
        <sql>UPDATE MACHINE_IN_PIT SET NOT_IN_USE = 0 WHERE NOT_IN_USE IS NULL</sql>
        <addNotNullConstraint columnName="NOT_IN_USE" columnDataType="BOOLEAN" tableName="MACHINE_IN_PIT"/>
        <rollback>
            <dropNotNullConstraint tableName="MACHINE_IN_PIT" columnName="NOT_IN_USE" columnDataType="BOOLEAN"/>
        </rollback>
    </changeSet>

</databaseChangeLog>
