<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping default-access="field" schema="model">

    <class name="minestar.production.domain.underground.schedule.ActiveDailyServiceScheduleImpl"
           proxy="minestar.production.domain.underground.schedule.ActiveDailyServiceSchedule"
           table="DAILY_SCHEDULE"
           dynamic-update="true">

        <meta attribute="alias" inherit="false">ACTIVEDAILYSERVICESCHEDULE</meta>
        <meta attribute="view-master">true</meta>
        <meta attribute="description">
            The details of the current schedule of when machines should be sent for daily service maintenance.
        </meta>
        <meta attribute="table">
            tablespace=MW_ENT
        </meta>
        <meta attribute="primary-key">
            tablespace=MW_IDXENT
        </meta>

        <cache usage="read-write" region="model"/>

        <id name="OID"
            type="java.lang.Long"
            column="OID">
            <generator class="com.mincom.env.base.persistence.IDGenerator"/>
        </id>

        <property name="startTimestamp"
                  type="TimestampType"
                  column="START_TIMESTAMP_UTC"
                  not-null="true">
            <meta attribute="timestamp">true</meta>
            <meta attribute="description">The timestamp of when this schedule was created and became active.</meta>
            <meta attribute="utc-description">
                The UTC timestamp of when this schedule was created and became active.
            </meta>
        </property>

        <list name="serviceScheduleLines" table="DAILY_SCHEDULE_LINE" cascade="all-delete-orphan"
              lazy="false">

            <meta attribute="description">
                A line in the current schedule of when an individual machine should be sent to daily service
                maintenance.
            </meta>
            <meta attribute="collection-table">
                tablespace=MW_ENT
            </meta>
            <meta attribute="collection-primary-key">
                tablespace=MW_IDXENT
            </meta>

            <key column="OID"/>
            <list-index column="LIST_INDEX"/>
            <composite-element
                    class="minestar.production.domain.underground.schedule.ActiveDailyServiceScheduleLineImpl">

                <property name="machineOID"
                          column="MACHINE_OID"
                          type="java.lang.Long"
                          not-null="true">
                    <meta attribute="description">
                        A reference to the machine (MSMODEL.MACHINE) that this schedule line applies to.
                    </meta>
                </property>

                <property name="shiftTypeID"
                          type="java.lang.Short"
                          column="SHIFT_TYPE_ID"
                          not-null="true">
                    <meta attribute="description">
                        The type of the shift that this scheduled line applies to.
                        0 = 1st 12hr shift
                        1 = 2nd 12hr shift
                        2 = 1st 8hr shift
                        3 = 2nd 8hr shift
                        4 = 3rd 8hr shift
                    </meta>
                </property>

                <property name="scheduledTime"
                          type="TimestampType"
                          column="START_TIME_UTC"
                          not-null="true">
                    <meta attribute="utc-description">
                        The UTC time of when the machine should be sent to daily service maintenance.
                        (The date part is ignored.)
                    </meta>
                    <meta attribute="description">
                        The time of when the machine should be sent to daily service maintenance.
                        (The date part is ignored.)
                    </meta>
                </property>

            </composite-element>
        </list>

    </class>

</hibernate-mapping>
