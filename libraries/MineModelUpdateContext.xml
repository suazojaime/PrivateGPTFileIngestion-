<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright (c) 2022 Caterpillar -->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="fieldInformationServiceMonitor" class="minestar.platform.service.monitor.FieldInformationServiceMonitor" init-method="init">
        <constructor-arg name="alarmService" ref="alarmServiceImpl"/>
        <constructor-arg name="sequenceValueService" ref="sequenceValueServiceImpl"/>
        <constructor-arg name="serverHeartbeatService" ref="serverHeartbeatServiceImpl"/>
    </bean>

    <bean id="mineModelUpdateService" class="minestar.minemodelupdate.MineModelUpdateService" lazy-init="true">
        <constructor-arg name="notification" ref="notification"/>
        <constructor-arg name="config" ref="mineModelUpdateConfig"/>
        <constructor-arg name="mineModelUpdateNotifier" ref="mineModelUpdateNotifier"/>
        <constructor-arg name="sequenceValueService" ref="sequenceValueServiceImpl"/>
        <constructor-arg name="componentProcessors">
            <list>
                <bean class="minestar.minemodelupdate.laneusage.AllLaneUsageUpdateProcessor">
                    <property name="laneUsageProvider" ref="autonomousStateServiceImpl"/>
                </bean>
                <bean class="minestar.minemodelupdate.layer.LayerUpdateProcessor" init-method="init">
                    <constructor-arg name="config" ref="mineModelUpdateConfig"/>
                    <constructor-arg name="sequenceValueService" ref="sequenceValueServiceImpl"/>
                    <constructor-arg name="notification" ref="notification"/>
                    <constructor-arg name="fieldInformationServiceMonitor" ref="fieldInformationServiceMonitor"/>
                </bean>
            </list>
        </constructor-arg>
    </bean>

    <bean id="mineModelUpdateNotifier" class="minestar.minemodelupdate.protocol.MineModelUpdateNotifierImpl" lazy-init="true" init-method="init">
        <property name="multicastAddress" value="tmac://${minestar.minemodelupdate.Config@ADDRESS}:${minestar.minemodelupdate.Config@PORT}"/>
        <property name="compressionEnabled" value="${minestar.minemodelupdate.Config@ENABLE_COMPRESSION}"/>
        <property name="compressor">
            <bean class="com.mincom.integ.field.util.ZlibCompressorImpl"/>
        </property>
        <property name="fieldCommunicationsService" ref="deferredFieldCommunicationsService"/>
    </bean>

</beans>
