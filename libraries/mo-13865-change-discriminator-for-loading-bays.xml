<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<databaseChangeLog xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
    <changeSet id="54f0ac22-515c-4aa8-88e2-d3a8b6da9b9d" author="MineStar" failOnError="false">
        <preConditions
                onFailMessage="Ignored LoadingBay Discriminator Update as MACHINE Table or ECF_CLASS_ID Column don't exist."
                onFail="MARK_RAN">
            <tableExists tableName="MACHINE"/>
            <columnExists tableName="MACHINE" columnName="ECF_CLASS_ID"/>
        </preConditions>
        <comment>MO-13865: Change discriminator for Loading Bays</comment>
        <sql>
            UPDATE MACHINE
            SET ECF_CLASS_ID = 'XAEntity.Machine.FixedPlant.LoadingBay'
            WHERE ECF_CLASS_ID = 'XAEntity.Machine.Mobile.LoadingTool.LoadingBay'
        </sql>
        <rollback>
            <sql>
                UPDATE MACHINE
                SET ECF_CLASS_ID = 'XAEntity.Machine.Mobile.LoadingTool.LoadingBay'
                WHERE ECF_CLASS_ID = 'XAEntity.Machine.FixedPlant.LoadingBay'
            </sql>
        </rollback>
    </changeSet>
</databaseChangeLog>

