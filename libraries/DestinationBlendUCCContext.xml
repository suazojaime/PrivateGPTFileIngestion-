<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright (c) 2022 Caterpillar -->

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:condbean="http://www.minestar.au.cat.com/springbeans/condbean"
       xsi:schemaLocation="
            http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
            http://www.minestar.au.cat.com/springbeans/condbean http://www.minestar.au.cat.com/springbeans/condbean/condbeans.xsd
       ">

    <condbean:cond privilege="BlendingToDestination">
        <!-- must have this -->
        <bean id="destinationBlendUCCImpl" class="minestar.mine.uifacade.blend.impl.DestinationBlendUCCImpl"
              lazy-init="true">
            <property name="destinationBlendHistoryService" ref="destinationBlendHistoryService"/>
            <property name="predictedBlendStatusUpdateCache" ref="predictedBlendStatusUpdateCache"/>
            <property name="machineUCC" ref="machineUCCImpl"/>
        </bean>
    </condbean:cond>


    <condbean:cond privilege="BlendingToDestination">
        <bean id="registerDestinationBlendUCCImpl" parent="registrationInstance" lazy-init="true">
            <constructor-arg value="Destination Blend UCC"/>
            <constructor-arg value="minestar.mine.uifacade.blend.DestinationBlendUCCFacade"/>
            <constructor-arg ref="destinationBlendUCCImpl"/>
        </bean>
    </condbean:cond>


    <condbean:cond privilege="BlendingToDestination">
        <!-- support for remoting -->
        <bean id="destinationBlendUCCProxy" class="org.springframework.aop.framework.ProxyFactoryBean">
            <property name="targetSource">
                <bean class="org.springframework.aop.target.LazyInitTargetSource">
                    <property name="targetBeanName" value="destinationBlendUCCImpl"/>
                </bean>
            </property>
        </bean>
    </condbean:cond>

    <condbean:cond privilege="BlendingToDestination">
        <bean parent="rmiServiceExporter">
            <property name="serviceName" value="destinationBlendUCC"/>
            <property name="service" ref="destinationBlendUCCProxy"/>
            <property name="serviceInterface" value="minestar.mine.uifacade.blend.DestinationBlendUCCFacade"/>
        </bean>
    </condbean:cond>

    <condbean:cond privilege="BlendingToDestination">
        <bean id="predictedBlendStatusUpdateCache" class="minestar.mine.uifacade.blend.collection.PredictedBlendStatusUpdateCache"
              lazy-init="true" init-method="init">
        </bean>
    </condbean:cond>

</beans>
