<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!-- Copyright (c) 2021 Caterpillar -->

<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
    <!--  STEP 1. Renaming tables V2_PROD_PLAN and V2_PROD_PLAN_JOB  -->
    <!--  STEP 2. Dropping all foreign keys referencing PROD_PLAN.PLAN_OID   -->
    <!--  STEP 3. Dropping all foreign keys referring PROD_PLAN_JOB.JOB_OID  -->
    <!--  STEP 4. Renaming primary key name of PROD_PLAN.PLAN_OID from V2_PROD_PLAN_PK to PROD_PLAN_PK -->
    <!--  STEP 5. Renaming Unique constraint V2_PROD_PLAN_EXTERNAL_REF_UK to PROD_PLAN_EXTERNAL_REF_UK -->
    <!--  STEP 6. Renaming primary key name of PROD_PLAN_JOB.JOB_OID from V2_PROD_PLAN_JOB_PK to PROD_PLAN_JOB_PK  -->
    <!--  STEP 7. Adding all foreign keys referring PROD_PLAN.PLAN_OID  -->
    <!--  STEP 8. Adding all foreign keys referring PROD_PLAN_JOB.JOB_OID  -->

    <!--  STEP 1  -->
    <changeSet id="694f4abf-c02f-4f5f-aa4b-5903dbbd5062" author="MineStar" context="Production/Production_Management" failOnError="true">
        <preConditions onFailMessage="Ignored Rename Table for V2_PROD_PLAN as table does not exist." onFail="MARK_RAN">
            <tableExists tableName="V2_PROD_PLAN"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <renameTable oldTableName="V2_PROD_PLAN" newTableName="PROD_PLAN"/>
    </changeSet>

    <changeSet id="a9c20771-ab01-48da-a51d-e7bccfc071f8" author="MineStar" context="Production/Production_Management" failOnError="true">
        <preConditions onFailMessage="Ignored Rename Table for V2_PROD_PLAN_JOB as table does not exist." onFail="MARK_RAN">
            <tableExists tableName="V2_PROD_PLAN_JOB"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <renameTable oldTableName="V2_PROD_PLAN_JOB" newTableName="PROD_PLAN_JOB"/>
    </changeSet>
    <!--  STEP 1 END  -->

    <!--  STEP 2  -->
    <!--  PROD_PLAN_DUMP_STOCKPILE_FK1  -->
    <changeSet id="10630a9e-4999-410b-90a0-cc3de1279366" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_DUMP_STOCKPILE_FK1 does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_DUMP_STOCKPILE" foreignKeyName="PROD_PLAN_DUMP_STOCKPILE_FK1"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_DUMP_STOCKPILE" constraintName="PROD_PLAN_DUMP_STOCKPILE_FK1"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_DUMP_STOCKPILE" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_DUMP_STOCKPILE_FK1" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_DUMP_CRUSHER_PLAN_FK  -->
    <changeSet id="9d8dda99-cfe5-4baa-b0e1-a99983781907" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_DUMP_CRUSHER_PLAN_FK does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_DUMP_CRUSHER" foreignKeyName="PROD_PLAN_DUMP_CRUSHER_PLAN_FK"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_DUMP_CRUSHER" constraintName="PROD_PLAN_DUMP_CRUSHER_PLAN_FK"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_DUMP_CRUSHER" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_DUMP_CRUSHER_PLAN_FK" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_DUMP_BLEND_PLAN_O_FK  -->
    <changeSet id="bea40fc2-1a62-4b8c-a036-e53e0a82a8d2" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_DUMP_BLEND_PLAN_O_FK does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_DUMP_BLEND" foreignKeyName="PROD_PLAN_DUMP_BLEND_PLAN_O_FK"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_DUMP_BLEND" constraintName="PROD_PLAN_DUMP_BLEND_PLAN_O_FK"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_DUMP_BLEND" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_DUMP_BLEND_PLAN_O_FK" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_METRIC_FK1  -->
    <changeSet id="3b0bc6bc-8519-408d-b76c-79dbd477c03c" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_METRIC_FK1 does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_METRIC" foreignKeyName="PROD_PLAN_METRIC_FK1"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_METRIC" constraintName="PROD_PLAN_METRIC_FK1"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_METRIC" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_METRIC_FK1" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_COMMENT_PLAN_OID_FK  -->
    <changeSet id="a58f6463-fc13-410f-be07-01c074ef0903" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_COMMENT_PLAN_OID_FK does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_COMMENT" foreignKeyName="PROD_PLAN_COMMENT_PLAN_OID_FK"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_COMMENT" constraintName="PROD_PLAN_COMMENT_PLAN_OID_FK"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_COMMENT" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_COMMENT_PLAN_OID_FK" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_SOURCE_STOCKPILE_FK1  -->
    <changeSet id="ceb415b6-5aa6-4fd8-802f-96cbfecc28b4" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_SOURCE_STOCKPILE_FK1 does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_SOURCE_STOCKPILE" foreignKeyName="PROD_PLAN_SOURCE_STOCKPILE_FK1"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_SOURCE_STOCKPILE" constraintName="PROD_PLAN_SOURCE_STOCKPILE_FK1"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_SOURCE_STOCKPILE" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_SOURCE_STOCKPILE_FK1" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_SOURCE_BLOCK_PLAN_FK  -->
    <changeSet id="59ed7310-78e4-43b9-b577-52e00e0f4d13" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_SOURCE_BLOCK_PLAN_FK does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_SOURCE_BLOCK" foreignKeyName="PROD_PLAN_SOURCE_BLOCK_PLAN_FK"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_SOURCE_BLOCK" constraintName="PROD_PLAN_SOURCE_BLOCK_PLAN_FK"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_SOURCE_BLOCK" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_SOURCE_BLOCK_PLAN_FK" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_REFERENCE_WARNIN_FK1  -->
    <changeSet id="3322c331-f251-4d79-af0a-78b75a007db9" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_REFERENCE_WARNIN_FK1 does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_REFERENCE_WARNING" foreignKeyName="PROD_PLAN_REFERENCE_WARNIN_FK1"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_REFERENCE_WARNING" constraintName="PROD_PLAN_REFERENCE_WARNIN_FK1"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_REFERENCE_WARNING" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_REFERENCE_WARNIN_FK1" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_TASK_PRODUCTION_FK1  -->
    <changeSet id="ae59da1b-5ebf-4d1a-8d1a-dcdbad3f710f" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_TASK_PRODUCTION_FK1 does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_TASK_PRODUCTION" foreignKeyName="PROD_PLAN_TASK_PRODUCTION_FK1"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_TASK_PRODUCTION" constraintName="PROD_PLAN_TASK_PRODUCTION_FK1"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_TASK_PRODUCTION" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_TASK_PRODUCTION_FK1" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_TASK_OPERATIONAL_FK1  -->
    <changeSet id="e10f6b59-f53a-4054-bccc-b19b73e3df4d" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_TASK_OPERATIONAL_FK1 does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_TASK_OPERATIONAL" foreignKeyName="PROD_PLAN_TASK_OPERATIONAL_FK1"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_TASK_OPERATIONAL" constraintName="PROD_PLAN_TASK_OPERATIONAL_FK1"/>
        <rollback/>
    </changeSet>
    <!--  PROD_PLAN_TASK_NON_PRODUCT_FK1  -->
    <changeSet id="227e62ad-7743-47d3-a89a-6732797a7db9" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_TASK_NON_PRODUCT_FK1 does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_TASK_NON_PRODUCTION" foreignKeyName="PROD_PLAN_TASK_NON_PRODUCT_FK1"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_TASK_NON_PRODUCTION" constraintName="PROD_PLAN_TASK_NON_PRODUCT_FK1"/>
        <rollback/>
    </changeSet>
    <!--  PROD_PLAN_JOB_PLAN_OID_FK  -->
    <changeSet id="4d393e44-2037-4723-bd7c-8065d8a4498f" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint V2_PROD_PLAN_JOB_PLAN_OID_FK does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_JOB" foreignKeyName="V2_PROD_PLAN_JOB_PLAN_OID_FK"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_JOB" constraintName="V2_PROD_PLAN_JOB_PLAN_OID_FK"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_JOB" baseColumnNames="PLAN_OID" constraintName="V2_PROD_PLAN_JOB_PLAN_OID_FK" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_METRIC_PLAN_OID_FK  -->
    <changeSet id="1aba5528-2d59-4161-948b-8b74cbaf1a29" author="MineStar" failOnError="false">
        <preConditions onFailMessage="Ignored dropping constraint as constraint PROD_PLAN_METRIC_PLAN_OID_FK does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_METRIC" foreignKeyName="PROD_PLAN_METRIC_PLAN_OID_FK"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_METRIC" constraintName="PROD_PLAN_METRIC_PLAN_OID_FK"/>
        <rollback>
            <comment>@EmptyRollback</comment>
        </rollback>
    </changeSet>
    <!--  STEP 2 END  -->

    <!--  STEP 3  -->
    <!--  PROD_PLAN_JOB_PRIMARY_SOUR_FK1  -->
    <changeSet id="2a942142-26bc-4598-815b-12de1768ed05" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_JOB_PRIMARY_SOUR_FK1 does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_JOB_PRIMARY_SOURCE" foreignKeyName="PROD_PLAN_JOB_PRIMARY_SOUR_FK1"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_JOB_PRIMARY_SOURCE" constraintName="PROD_PLAN_JOB_PRIMARY_SOUR_FK1"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_JOB_PRIMARY_SOURCE" baseColumnNames="JOB_OID" constraintName="PROD_PLAN_JOB_PRIMARY_SOUR_FK1" referencedTableName="PROD_PLAN_JOB" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_JOB_PRIMARY_DUMP_FK1  -->
    <changeSet id="b1747a98-585d-4f5c-ac4a-a1c9380451ad" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_JOB_PRIMARY_DUMP_FK1 does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_JOB_PRIMARY_DUMP" foreignKeyName="PROD_PLAN_JOB_PRIMARY_DUMP_FK1"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_JOB_PRIMARY_DUMP" constraintName="PROD_PLAN_JOB_PRIMARY_DUMP_FK1"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_JOB_PRIMARY_DUMP" baseColumnNames="JOB_OID" constraintName="PROD_PLAN_JOB_PRIMARY_DUMP_FK1" referencedTableName="PROD_PLAN_JOB" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_JOB_EQUIPMENT_FK1  -->
    <changeSet id="387b6596-8443-466b-843a-2bd832b0000f" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_JOB_EQUIPMENT_FK1 does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_JOB_EQUIPMENT" foreignKeyName="PROD_PLAN_JOB_EQUIPMENT_FK1"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_JOB_EQUIPMENT" constraintName="PROD_PLAN_JOB_EQUIPMENT_FK1"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_JOB_EQUIPMENT" baseColumnNames="JOB_OID" constraintName="PROD_PLAN_JOB_EQUIPMENT_FK1" referencedTableName="PROD_PLAN_JOB" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_JOB_ALTERNATE_SO_FK1  -->
    <changeSet id="805b0118-880c-4d9d-aabb-f193789c25e2" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_JOB_ALTERNATE_SO_FK1 does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_JOB_ALTERNATE_SOURCE" foreignKeyName="PROD_PLAN_JOB_ALTERNATE_SO_FK1"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_JOB_ALTERNATE_SOURCE" constraintName="PROD_PLAN_JOB_ALTERNATE_SO_FK1"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_JOB_ALTERNATE_SOURCE" baseColumnNames="JOB_OID" constraintName="PROD_PLAN_JOB_ALTERNATE_SO_FK1" referencedTableName="PROD_PLAN_JOB" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  PROD_PLAN_JOB_ALTERNATE_DU_FK1  -->
    <changeSet id="5afe260c-665f-4a74-b0c3-e1559e65fa38" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_JOB_ALTERNATE_DU_FK1 does not exist" onFail="MARK_RAN">
            <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_JOB_ALTERNATE_DUMP" foreignKeyName="PROD_PLAN_JOB_ALTERNATE_DU_FK1"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropForeignKeyConstraint baseTableName="PROD_PLAN_JOB_ALTERNATE_DUMP" constraintName="PROD_PLAN_JOB_ALTERNATE_DU_FK1"/>
        <rollback>
            <addForeignKeyConstraint baseTableName="PROD_PLAN_JOB_ALTERNATE_DUMP" baseColumnNames="JOB_OID" constraintName="PROD_PLAN_JOB_ALTERNATE_DU_FK1" referencedTableName="PROD_PLAN_JOB" referencedColumnNames="OID" onDelete="NO ACTION"/>
        </rollback>
    </changeSet>
    <!--  STEP 3 END  -->

    <!-- STEP 4 -->
    <changeSet id="fc5a69c1-b1fc-41e2-8ae0-35372d10ecc6" author="MineStar" context="Production/Production_Management" failOnError="true">
        <preConditions onFailMessage="Ignored dropping primary key V2_PROD_PLAN_PK of table PROD_PLAN as V2_PROD_PLAN_PK does not exist." onFail="MARK_RAN">
            <primaryKeyExists primaryKeyName="V2_PROD_PLAN_PK" tableName="PROD_PLAN"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropPrimaryKey constraintName="V2_PROD_PLAN_PK" tableName="PROD_PLAN"/>
        <rollback>
            <addPrimaryKey columnNames="OID" constraintName="V2_PROD_PLAN_PK" tableName="PROD_PLAN"/>
        </rollback>
    </changeSet>

    <changeSet id="006683c8-f046-4041-8052-bf23b1ed3cdb" author="MineStar" context="Production/Production_Management" failOnError="true">
        <preConditions onFailMessage="Ignored adding primary key from PROD_PLAN_PK of table PROD_PLAN as DropPrimaryKey of V2_PROD_PLAN_PK failed or PROD_PLAN_PK already exists." onFail="MARK_RAN">
            <not>
                <primaryKeyExists primaryKeyName="V2_PROD_PLAN_PK" tableName="PROD_PLAN"/>
                <primaryKeyExists primaryKeyName="PROD_PLAN_PK" tableName="PROD_PLAN"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addPrimaryKey columnNames="OID" constraintName="PROD_PLAN_PK" tableName="PROD_PLAN"/>
    </changeSet>
    <!--  STEP 4 END  -->
    <!--  STEP 5  -->
    <changeSet id="bd7ab494-b130-4371-b906-d69ebf5a5218" author="MineStar" context="Production/Production_Management" failOnError="true">
        <preConditions onFailMessage="Ignored dropping unique constraint V2_PROD_PLAN_EXTERNAL_REF_UK of table PROD_PLAN as V2_PROD_PLAN_EXTERNAL_REF_UK does not exist." onFail="MARK_RAN">
            <indexExists indexName="V2_PROD_PLAN_EXTERNAL_REF_UK" tableName="PROD_PLAN"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropUniqueConstraint constraintName="V2_PROD_PLAN_EXTERNAL_REF_UK" tableName="PROD_PLAN"/>
        <rollback>
            <addUniqueConstraint columnNames="EXTERNAL_REF" constraintName="V2_PROD_PLAN_EXTERNAL_REF_UK" tableName="PROD_PLAN"/>
        </rollback>
    </changeSet>

    <changeSet id="eaeb4c72-86e9-43eb-b4c8-2bf789884917" author="MineStar" context="Production/Production_Management" failOnError="true">
        <preConditions onFailMessage="Ignored adding unique constraint PROD_PLAN_EXTERNAL_REF_UK of table PROD_PLAN as PROD_PLAN_EXTERNAL_REF_UK already exists." onFail="MARK_RAN">
            <not>
                <indexExists indexName="PROD_PLAN_EXTERNAL_REF_UK" tableName="PROD_PLAN"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addUniqueConstraint columnNames="EXTERNAL_REF" constraintName="PROD_PLAN_EXTERNAL_REF_UK" tableName="PROD_PLAN"/>
    </changeSet>
    <!--  STEP 5 END  -->

    <!--  STEP 6 -->
    <changeSet id="3526a872-df8a-4c6a-8fbf-9051335b5648" author="MineStar" context="Production/Production_Management" failOnError="true">
        <preConditions onFailMessage="Ignored dropping primary key from V2_PROD_PLAN_JOB_PK of table PROD_PLAN_JOB as V2_PROD_PLAN_JOB_PK does not exist." onFail="MARK_RAN">
            <primaryKeyExists primaryKeyName="V2_PROD_PLAN_JOB_PK" tableName="PROD_PLAN_JOB"/>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <dropPrimaryKey constraintName="V2_PROD_PLAN_JOB_PK" tableName="PROD_PLAN_JOB"/>
        <rollback>
            <addPrimaryKey columnNames="OID" constraintName="V2_PROD_PLAN_JOB_PK" tableName="PROD_PLAN_JOB"/>
        </rollback>
    </changeSet>

    <changeSet id="ac700403-c743-46e8-b4e4-387226ab41d3" author="MineStar" context="Production/Production_Management" failOnError="true">
        <preConditions onFailMessage="Ignored adding primary key PROD_PLAN_JOB_PK of table PROD_PLAN_JOB as DropPrimaryKey of V2_PROD_PLAN_JOB_PK failed or PROD_PLAN_JOB_PK already exists." onFail="MARK_RAN">
            <not>
                <primaryKeyExists primaryKeyName="V2_PROD_PLAN_JOB_PK" tableName="PROD_PLAN_JOB"/>
                <primaryKeyExists primaryKeyName="PROD_PLAN_JOB_PK" tableName="PROD_PLAN_JOB"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addPrimaryKey columnNames="OID" constraintName="PROD_PLAN_JOB_PK" tableName="PROD_PLAN_JOB"/>
    </changeSet>
    <!--  STEP 6 END  -->

    <!--  STEP 7  -->
    <!--  PROD_PLAN_DUMP_STOCKPILE_FK1  -->
    <changeSet id="17157958-2b97-4506-9ca9-11bb9991ac98" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_DUMP_STOCKPILE_FK1 already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_DUMP_STOCKPILE" foreignKeyName="PROD_PLAN_DUMP_STOCKPILE_FK1"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_DUMP_STOCKPILE" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_DUMP_STOCKPILE_FK1" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_DUMP_CRUSHER_PLAN_FK  -->
    <changeSet id="238fc0f0-897c-42bc-9fc0-71418617bb89" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_DUMP_CRUSHER_PLAN_FK already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_DUMP_CRUSHER" foreignKeyName="PROD_PLAN_DUMP_CRUSHER_PLAN_FK"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_DUMP_CRUSHER" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_DUMP_CRUSHER_PLAN_FK" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_DUMP_BLEND_PLAN_O_FK  -->
    <changeSet id="c05d5b0d-998a-4c1e-b376-45b829fe5f2f" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_DUMP_BLEND_PLAN_O_FK already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_DUMP_BLEND" foreignKeyName="PROD_PLAN_DUMP_BLEND_PLAN_O_FK"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_DUMP_BLEND" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_DUMP_BLEND_PLAN_O_FK" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_METRIC_FK1  -->
    <changeSet id="9b9d1f2e-f65f-4017-b8ec-c6e9bbb445bb" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_METRIC_FK1 already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_METRIC" foreignKeyName="PROD_PLAN_METRIC_FK1"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_METRIC" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_METRIC_FK1" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_COMMENT_PLAN_OID_FK  -->
    <changeSet id="4901968e-4ad1-42a1-bb95-d9e72519f48a" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_COMMENT_PLAN_OID_FK already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_COMMENT" foreignKeyName="PROD_PLAN_COMMENT_PLAN_OID_FK"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_COMMENT" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_COMMENT_PLAN_OID_FK" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_SOURCE_STOCKPILE_FK1  -->
    <changeSet id="f7a28194-a53b-4aa8-9873-973cce0c7dcd" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_SOURCE_STOCKPILE_FK1 already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_SOURCE_STOCKPILE" foreignKeyName="PROD_PLAN_SOURCE_STOCKPILE_FK1"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_SOURCE_STOCKPILE" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_SOURCE_STOCKPILE_FK1" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_SOURCE_BLOCK_PLAN_FK  -->
    <changeSet id="16daa912-3d2d-417f-b291-b14909012396" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_SOURCE_BLOCK_PLAN_FK already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_SOURCE_BLOCK" foreignKeyName="PROD_PLAN_SOURCE_BLOCK_PLAN_FK"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_SOURCE_BLOCK" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_SOURCE_BLOCK_PLAN_FK" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_REFERENCE_WARNIN_FK1  -->
    <changeSet id="dd5eeb0e-13ec-473c-b420-46900a0a5bfa" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_REFERENCE_WARNIN_FK1 already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_REFERENCE_WARNING" foreignKeyName="PROD_PLAN_REFERENCE_WARNIN_FK1"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_REFERENCE_WARNING" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_REFERENCE_WARNIN_FK1" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_TASK_PRODUCTION_FK1  -->
    <changeSet id="4e4a65ee-b596-4531-99a7-40662f8ee02f" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_TASK_PRODUCTION_FK1 already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_TASK_PRODUCTION" foreignKeyName="PROD_PLAN_TASK_PRODUCTION_FK1"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_TASK_PRODUCTION" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_TASK_PRODUCTION_FK1" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_TASK_OPERATIONAL_FK1  -->
    <changeSet id="2f717071-7c5e-4b2c-81bb-3be632959d06" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_TASK_OPERATIONAL_FK1 already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_TASK_OPERATIONAL" foreignKeyName="PROD_PLAN_TASK_OPERATIONAL_FK1"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_TASK_OPERATIONAL" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_TASK_OPERATIONAL_FK1" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
        <rollback/>
    </changeSet>
    <!--  PROD_PLAN_TASK_NON_PRODUCT_FK1  -->
    <changeSet id="b62c764c-512c-46f8-9af6-51700b565408" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_TASK_NON_PRODUCT_FK1 already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_TASK_NON_PRODUCTION" foreignKeyName="PROD_PLAN_TASK_NON_PRODUCT_FK1"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_TASK_NON_PRODUCTION" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_TASK_NON_PRODUCT_FK1" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
        <rollback/>
    </changeSet>
    <!--  PROD_PLAN_JOB_PLAN_OID_FK  -->
    <changeSet id="f52281d8-a45d-46d3-94dd-b54b2174f49d" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_JOB_PLAN_OID_FK already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_JOB" foreignKeyName="PROD_PLAN_JOB_PLAN_OID_FK"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_JOB" baseColumnNames="PLAN_OID" constraintName="PROD_PLAN_JOB_PLAN_OID_FK" referencedTableName="PROD_PLAN" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  STEP 7 END  -->

    <!--  STEP 8  -->
    <!--  PROD_PLAN_JOB_PRIMARY_SOUR_FK1  -->
    <changeSet id="c3a649c6-4a4b-45ff-a7db-ea8b8821fd1d" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_JOB_PRIMARY_SOUR_FK1 already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_JOB_PRIMARY_SOURCE" foreignKeyName="PROD_PLAN_JOB_PRIMARY_SOUR_FK1"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_JOB_PRIMARY_SOURCE" baseColumnNames="JOB_OID" constraintName="PROD_PLAN_JOB_PRIMARY_SOUR_FK1" referencedTableName="PROD_PLAN_JOB" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_JOB_PRIMARY_DUMP_FK1  -->
    <changeSet id="1f6796d1-1467-4e7c-a442-808aab48c37c" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_JOB_PRIMARY_DUMP_FK1 already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_JOB_PRIMARY_DUMP" foreignKeyName="PROD_PLAN_JOB_PRIMARY_DUMP_FK1"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_JOB_PRIMARY_DUMP" baseColumnNames="JOB_OID" constraintName="PROD_PLAN_JOB_PRIMARY_DUMP_FK1" referencedTableName="PROD_PLAN_JOB" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_JOB_EQUIPMENT_FK1  -->
    <changeSet id="37e0d62b-fc31-4ffa-9d56-ed9eeb6df9fc" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_JOB_EQUIPMENT_FK1 already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_JOB_EQUIPMENT" foreignKeyName="PROD_PLAN_JOB_EQUIPMENT_FK1"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_JOB_EQUIPMENT" baseColumnNames="JOB_OID" constraintName="PROD_PLAN_JOB_EQUIPMENT_FK1" referencedTableName="PROD_PLAN_JOB" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_JOB_ALTERNATE_SO_FK1  -->
    <changeSet id="6a799c41-06e2-461d-9192-da69cc57bf73" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_JOB_ALTERNATE_SO_FK1 already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_JOB_ALTERNATE_SOURCE" foreignKeyName="PROD_PLAN_JOB_ALTERNATE_SO_FK1"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_JOB_ALTERNATE_SOURCE" baseColumnNames="JOB_OID" constraintName="PROD_PLAN_JOB_ALTERNATE_SO_FK1" referencedTableName="PROD_PLAN_JOB" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  PROD_PLAN_JOB_ALTERNATE_DU_FK1  -->
    <changeSet id="113d1618-9ec7-4fc5-8626-62af483d5271" author="MineStar" failOnError="true">
        <preConditions onFailMessage="Ignored constraint as constraint PROD_PLAN_JOB_ALTERNATE_DU_FK1 already exists" onFail="MARK_RAN">
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="PROD_PLAN_JOB_ALTERNATE_DUMP" foreignKeyName="PROD_PLAN_JOB_ALTERNATE_DU_FK1"/>
            </not>
        </preConditions>
        <comment>PMM-115: Rename PROD_PLAN and PROD_PLAN_JOB tables</comment>
        <addForeignKeyConstraint baseTableName="PROD_PLAN_JOB_ALTERNATE_DUMP" baseColumnNames="JOB_OID" constraintName="PROD_PLAN_JOB_ALTERNATE_DU_FK1" referencedTableName="PROD_PLAN_JOB" referencedColumnNames="OID" onDelete="NO ACTION"/>
    </changeSet>
    <!--  STEP 8 END  -->
</databaseChangeLog>
