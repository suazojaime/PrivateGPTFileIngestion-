<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
    <changeSet id="eed419b0-8600-4767-a6ca-2860d1877b48" author="MineStar" context="Underground/Underground_Management" failOnError="false">
        <preConditions onFailMessage="Ignored DropColumn for MAX_SPEED of table ZONE_MACHINE_RELATION as column does not exist." onFail="MARK_RAN">
            <columnExists tableName="ZONE_MACHINE_RELATION" columnName="MAX_SPEED"/>
        </preConditions>
        <comment>FUG-4207: DropColumn ZONE_MACHINE_RELATION.MAX_SPEED</comment>
        <dropColumn columnName="MAX_SPEED" tableName="ZONE_MACHINE_RELATION"/>
        <rollback>
            <addColumn tableName="ZONE_MACHINE_RELATION">
                <column name="MAX_SPEED" type="DOUBLE" remarks="The speed limit for any machine that travels in this zone">
                    <constraints nullable="false"/>
                </column>
            </addColumn>
        </rollback>
    </changeSet>
    <changeSet id="c412be25-3a84-4c92-b1c2-df6a0f734a70" author="MineStar" context="Underground/Underground_Management" failOnError="false">
        <preConditions onFailMessage="Ignored DropConstraint for PASSABLE of table ZONE_MACHINE_RELATION as column does not exist." onFail="MARK_RAN">
            <columnExists tableName="ZONE_MACHINE_RELATION" columnName="PASSABLE"/>
        </preConditions>
        <comment>FUG-4207: DropColumn ZONE_MACHINE_RELATION.PASSABLE Constraint</comment>
        <dropNotNullConstraint columnDataType="BOOLEAN" columnName="PASSABLE" tableName="ZONE_MACHINE_RELATION"/>
        <dropDefaultValue tableName="ZONE_MACHINE_RELATION" columnName="PASSABLE"/>
        <rollback>
            <addNotNullConstraint columnDataType="BOOLEAN" columnName="PASSABLE" tableName="ZONE_MACHINE_RELATION"/>
            <addDefaultValue tableName="ZONE_MACHINE_RELATION" columnName="PASSABLE" defaultValueBoolean="true"/>
        </rollback>
    </changeSet>
    <changeSet id="9e0d84e6-7ae9-42a9-80a4-89d8ac7b7bc7" author="MineStar" context="Underground/Underground_Management" failOnError="false">
        <preConditions onFailMessage="Ignored DropColumn for PASSABLE of table ZONE_MACHINE_RELATION as column does not exist." onFail="MARK_RAN">
            <columnExists tableName="ZONE_MACHINE_RELATION" columnName="PASSABLE"/>
        </preConditions>
        <comment>FUG-4207: DropColumn ZONE_MACHINE_RELATION.PASSABLE</comment>
        <dropColumn columnName="PASSABLE" tableName="ZONE_MACHINE_RELATION"/>
        <rollback>
            <addColumn tableName="ZONE_MACHINE_RELATION">
                <column name="PASSABLE" type="BOOLEAN" defaultValueBoolean="true" remarks="Is this zone PASSABLE"/>
            </addColumn>
        </rollback>
    </changeSet>
</databaseChangeLog>
