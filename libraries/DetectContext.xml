<?xml version="1.0" encoding="UTF-8"?>

<!-- Copyright (c) 2022, Caterpillar, Brisbane Australia. All rights reserved. -->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
            http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       ">

    <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->
    <!-- Contains beans that are only required if DETECT is licensed -->
    <!-- +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ -->

    <bean id="incidentDao" class="minestar.mine.service.incident.impl.IncidentMessageDaoImpl" parent="minestarDao" lazy-init="true"/>

    <bean id="incidentReportDao" class="minestar.mine.service.incident.report.IncidentReportDaoImpl" parent="minestarDao" lazy-init="true">
        <property name="sequenceValueService" ref="sequenceValueServiceImpl"/>
    </bean>

    <bean id="incidentReportIncidentDao" class="minestar.mine.service.incident.report.IncidentReportIncidentDaoImpl" parent="minestarDao" lazy-init="true"/>

    <bean id="incidentCategoryDao" class="minestar.mine.service.incident.impl.IncidentCategoryDaoImpl" parent="minestarDao" lazy-init="true"/>

    <bean id="incidentCauseDao" class="minestar.mine.service.incident.impl.IncidentCauseDaoImpl" parent="minestarDao" lazy-init="true"/>

    <bean id="incidentManagementServiceImpl" class="minestar.mine.service.incident.impl.IncidentManagementServiceImpl"
            lazy-init="true" init-method="init">
        <property name="incidentDao" ref="incidentDao"/>
        <property name="incidentReportDao" ref="incidentReportDao"/>
        <property name="personnelService" ref="personnelServiceImpl"/>
        <property name="userService" ref="userServiceImpl"/>
        <property name="incidentCategoryDao" ref="incidentCategoryDao"/>
        <property name="incidentCauseDao" ref="incidentCauseDao"/>
        <property name="incidentReportIncidentDao" ref="incidentReportIncidentDao"/>
        <property name="notification" ref="notification"/>
    </bean>

    <bean id="registerIncidentManagementService" parent="registrationInstance" lazy-init="true">
        <constructor-arg value="Incident Management Service"/>
        <constructor-arg value="minestar.mine.service.incident.IncidentManagementService"/>
        <constructor-arg ref="incidentManagementServiceImpl"/>
    </bean>

    <bean id="incidentMessageListenerImpl" class="com.mincom.integ.field.nodes.incident.message.IncidentMessageListenerImpl"
          init-method="init" lazy-init="true">
        <property name="incidentFTPService" ref="incidentFTPServiceImpl"/>
    </bean>

    <bean id="registerIncidentMessageListener" parent="registrationInstance" lazy-init="true">
        <constructor-arg value="Incident Message Listener"/>
        <constructor-arg value="com.mincom.integ.field.nodes.incident.message.IncidentMessageListener"/>
        <constructor-arg ref="incidentMessageListenerImpl"/>
    </bean>

    <bean id="incidentFTPExecutionMonitorImpl" class="com.mincom.integ.field.nodes.incident.ftp.impl.IncidentFTPExecutionMonitor" lazy-init="true">
    </bean>

    <bean id="incidentFTPCoalescorImpl" class="com.mincom.integ.field.nodes.incident.ftp.impl.IncidentFTPCoalescor" lazy-init="true">
    </bean>

    <bean id="incidentFTPDequeueorImpl" class="com.mincom.integ.field.nodes.incident.ftp.impl.IncidentFTPDequeueor" lazy-init="true">
        <property name="executionMonitor" ref="incidentFTPExecutionMonitorImpl"/>
    </bean>

    <bean id="incidentFTPJobSupplier" class="com.mincom.integ.field.nodes.incident.ftp.impl.IncidentFTPJobSupplier" lazy-init="true">
        <property name="jobListener" ref="incidentFtpJobListenerImpl"/>
        <property name="alarmService" ref="alarmServiceImpl"/>
    </bean>

    <bean id="managedQueue" class="minestar.util.queue.ManagedQueue" lazy-init="true">
        <constructor-arg ref="incidentFTPDequeueorImpl"/>
        <constructor-arg ref="incidentFTPCoalescorImpl"/>
    </bean>

    <bean id="incidentFTPServiceImpl" class="com.mincom.integ.field.nodes.incident.ftp.impl.IncidentFTPServiceImpl" lazy-init="true">
        <property name="executionMonitor" ref="incidentFTPExecutionMonitorImpl"/>
        <property name="managedQueue" ref="managedQueue"/>
        <property name="incidentFTPJobSupplier" ref="incidentFTPJobSupplier"/>
    </bean>

    <bean id="incidentFtpJobListenerImpl" class="com.mincom.integ.field.nodes.incident.ftp.impl.IncidentFTPJobListenerImpl" lazy-init="true">
        <property name="incidentMessageService" ref="incidentFTPMessageServiceImpl"/>
    </bean>

    <bean id="incidentMessageArrivalProcessorImpl" class="com.mincom.integ.field.nodes.incident.ftp.impl.IncidentMessageArrivalProcessorImpl"
          lazy-init="true" init-method="init">
        <property name="incidentService" ref="incidentManagementServiceImpl"/>
        <property name="pitModelService" ref="pitModelServiceImpl"/>
        <property name="laneOperations" ref="laneLayoutServiceImpl"/>
        <property name="zoneLayoutService" ref="zoneLayoutServiceImpl"/>
        <property name="alarmService" ref="alarmServiceImpl"/>
        <property name="txManager" ref="minestarTransactionManager"/>
    </bean>

    <bean id="registerIncidentMessageArrivalProcessor" parent="registrationInstance" lazy-init="true">
        <constructor-arg value="Incident Message Arrival Processor"/>
        <constructor-arg value="com.mincom.integ.field.nodes.incident.ftp.IncidentMessageArrivalProcessor"/>
        <constructor-arg ref="incidentMessageArrivalProcessorImpl"/>
    </bean>

    <bean id="incidentFTPMessageServiceImpl" class="com.mincom.integ.field.nodes.incident.ftp.impl.IncidentFTPMessageServiceImpl" lazy-init="true">
        <property name="incidentFileReader" ref="incidentFileReaderImpl"/>
        <property name="incidentMessageArrivalProcessor" ref="incidentMessageArrivalProcessorImpl"/>
    </bean>


    <bean id="incidentFileReaderImpl" class="com.mincom.integ.field.nodes.incident.ftp.file.impl.IncidentFileReaderImpl" lazy-init="true">
    </bean>

    <bean id="v2xOnboardFTPUpdateJobSupplier" class="com.mincom.integ.field.nodes.incident.ftp.impl.OnboardV2XUpdateJobSupplier" lazy-init="true">
        <property name="jobListener" ref="v2XOnboardUpdateJobListenerImpl"/>
    </bean>

    <bean id="v2XOnboardUpdateJobListenerImpl" class="com.mincom.integ.field.nodes.incident.ftp.impl.OnboardV2XUpdateJobListenerImpl" lazy-init="true" init-method="init">
        <property name="mineFleetService" ref="mineFleetServiceImpl"/>
        <property name="onboardV2XUpdateService" ref="onboardV2XUpdateServiceImpl"/>
    </bean>


    <bean id="v2XOnboardUpdateMessageListenerImpl" class="com.mincom.integ.field.nodes.incident.message.OnboardV2XUpdateMessageListenerImpl" lazy-init="true" init-method="init">
        <property name="onboardV2XUpdateService" ref="onboardV2XUpdateServiceImpl"/>
    </bean>

    <bean id="registerOnboardV2XUpdateMessageListener" parent="registrationInstance" lazy-init="true">
        <constructor-arg value="Onboard V2X Update Message Listener"/>
        <constructor-arg value="com.mincom.integ.field.nodes.incident.message.OnboardV2XUpdateMessageListener"/>
        <constructor-arg ref="v2XOnboardUpdateMessageListenerImpl"/>
    </bean>

    <bean id="onboardV2XUpdateServiceImpl" class="com.mincom.integ.field.nodes.incident.ftp.impl.OnboardV2XUpdateServiceImpl" lazy-init="true">
        <property name="v2XOnboardUpdateJobSupplier" ref="v2xOnboardFTPUpdateJobSupplier"/>
    </bean>

</beans>
