<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright (c) 2020 Caterpillar -->

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="kpiAnnotationDaoImpl" class="minestar.production.persistence.kpisummaries.impl.KpiAnnotationDaoImpl" lazy-init="true">
        <property name="sessionFactory" ref="minestarSessionFactory"/>
    </bean>

    <bean id="historicRealTimeKpiServiceImpl" class="minestar.production.service.kpisummaries.production.impl.HistoricRealTimeKpiServiceImpl"
          lazy-init="true">
        <property name="historicRealTimeKpiDao">
            <bean class="minestar.production.persistence.kpisummaries.impl.HistoricRealTimeKpiDaoImpl">
                <property name="sessionFactory" ref="minestarSessionFactory"/>
            </bean>
        </property>
    </bean>

    <bean id="kpiAnnotationServiceImpl" class="minestar.production.service.kpisummaries.production.impl.KpiAnnotationServiceImpl"
         lazy-init="true">
        <property name="kpiAnnotationDao" ref="kpiAnnotationDaoImpl"/>
    </bean>

    <bean id="crusherHangTimeServiceImpl" class="minestar.production.service.kpisummaries.production.impl.CrusherHangTimeServiceImpl"
          init-method="init" lazy-init="true">
        <property name="mineFleetService" ref="mineFleetServiceImpl"/>
        <property name="notification" ref="notification"/>
        <property name="cycleService" ref="cycleServiceImpl"/>
        <property name="historicRealTimeKpiService" ref="historicRealTimeKpiServiceImpl"/>
        <property name="delayManagementService" ref="delayManagementServiceImpl"/>
    </bean>

    <bean id="registerCrusherHangTimeService" parent="registrationInstance" lazy-init="true">
        <constructor-arg value="Crusher Hang Time Service"/>
        <constructor-arg value="minestar.production.service.kpisummaries.production.CrusherHangTimeService"/>
        <constructor-arg ref="crusherHangTimeServiceImpl"/>
    </bean>

    <bean id="shiftPlanningTargetsServiceImpl" class="minestar.production.service.shift.impl.ShiftPlanningTargetsServiceImpl"
          init-method="init" lazy-init="true">
    </bean>

    <bean id="registerShiftPlanningTargetsService" parent="registrationInstance" lazy-init="true">
        <constructor-arg value="Shift Planning Targets Service"/>
        <constructor-arg value="minestar.production.service.shift.ShiftPlanningTargetsService"/>
        <constructor-arg ref="shiftPlanningTargetsServiceImpl"/>
    </bean>

    <bean id="shiftProductionPlanServiceImpl" class="minestar.production.service.shift.impl.ShiftProductionPlanServiceImpl"
          init-method="init" depends-on="shiftPlanningTargetsServiceImpl" lazy-init="true">
        <property name="mineFleetService" ref="mineFleetServiceImpl"/>
        <property name="shiftService" ref="shiftServiceImpl"/>
        <property name="shiftPlanningTargetsService" ref="shiftPlanningTargetsServiceImpl"/>
        <property name="notification" ref="notification"/>
    </bean>

    <bean id="registerShiftProductionPlanService" parent="registrationInstance" lazy-init="true">
        <constructor-arg value="Shift Production Planning Service"/>
        <constructor-arg value="minestar.production.service.shift.ShiftProductionPlanService"/>
        <constructor-arg ref="shiftProductionPlanServiceImpl"/>
    </bean>

    <bean id="registerKpiAnnotationService" parent="registrationInstance" lazy-init="true">
        <constructor-arg value="Kpi Annotation Service"/>
        <constructor-arg value="minestar.production.service.kpisummaries.production.KpiAnnotationService"/>
        <constructor-arg ref="kpiAnnotationServiceImpl"/>
    </bean>

    <bean id="fullShiftService" class="java.lang.Object" lazy-init="true"
      depends-on="registerShiftProductionPlanService,registerKpiAnnotationService,registerShiftPlanningTargetsService, registerCrusherHangTimeService, registerHistoricalKpiCollectionCache, registerProductionKpiCollectionCache">
    </bean>

    <bean id="historicProductivityKpiCacheImpl" class="minestar.production.service.kpisummaries.cache.HistoricProductivityKpiCacheImpl"
          init-method="init" lazy-init="true">
        <property name="historicRealTimeKpiService" ref="historicRealTimeKpiServiceImpl"/>
        <property name="notification" ref="notification"/>
    </bean>

    <bean id="historicKpiCollectionCacheImpl" class="minestar.production.service.kpisummaries.cache.HistoricKpiCollectionCacheImpl"
          init-method="init" lazy-init="true">
        <property name="mineFleetService" ref="mineFleetServiceImpl"/>
        <property name="materialManagementService" ref="materialManagementServiceImpl"/>
        <property name="historicProductivityKpiCache" ref="historicProductivityKpiCacheImpl"/>
        <property name="historicRealTimeKpiService" ref="historicRealTimeKpiServiceImpl"/>
        <property name="notification" ref="notification"/>
    </bean>

    <bean id="registerHistoricalKpiCollectionCache" parent="registrationInstance" lazy-init="true">
        <constructor-arg value="Historical Kpi Collection"/>
        <constructor-arg value="minestar.production.service.kpisummaries.cache.HistoricKpiCollectionCache"/>
        <constructor-arg ref="historicKpiCollectionCacheImpl"/>
    </bean>

    <bean id="productionKpiCacheImpl" class="minestar.production.service.kpisummaries.cache.ProductionKpiCacheImpl"
          init-method="init" lazy-init="true">
        <property name="crusherHangTimeService" ref="crusherHangTimeServiceImpl"/>
        <property name="historicProductivityKpiCache" ref="historicProductivityKpiCacheImpl"/>
        <property name="mineFleetService" ref="mineFleetServiceImpl"/>
    </bean>

    <bean id="registerProductionKpiCollectionCache" parent="registrationInstance" lazy-init="true">
        <constructor-arg value="Kpi Production Collection"/>
        <constructor-arg value="minestar.production.service.kpisummaries.cache.ProductionKpiCache"/>
        <constructor-arg ref="productionKpiCacheImpl"/>
    </bean>

    <bean id="productionKpiSummaryServiceImpl" class="minestar.production.service.kpisummaries.ProductionKpiSummaryServiceImpl"
        lazy-init="true" init-method="init">
        <property name="materialManagementService" ref="materialManagementServiceImpl"/>
        <property name="mineFleetService" ref="mineFleetServiceImpl"/>
        <property name="pitModelService" ref="pitModelServiceImpl"/>
        <property name="shiftProductionPlanService" ref="shiftProductionPlanServiceImpl"/>
        <property name="shiftPlanningTargetsService" ref="shiftPlanningTargetsServiceImpl"/>
        <property name="siteProductivityService" ref="siteProductivityServiceImpl"/>
        <property name="delayManagementService" ref="delayManagementServiceImpl"/>
        <property name="shiftService" ref="shiftServiceImpl"/>
        <property name="historicKpiCollectionCache" ref="historicKpiCollectionCacheImpl"/>
        <property name="productionKpiCache" ref="productionKpiCacheImpl"/>

    </bean>

    <bean id="registerProductionKpiSummaryService" parent="registrationInstance" lazy-init="true">
        <constructor-arg value="Production Kpi Summary Service"/>
        <constructor-arg value="minestar.production.service.kpisummaries.ProductionKpiSummaryService"/>
        <constructor-arg ref="productionKpiSummaryServiceImpl"/>
    </bean>

</beans>
