<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd http://www.liquibase.org/xml/ns/dbchangelog-ext /dbchangelog-ext-3.1.xsd">

    <changeSet id="e867bf40-bc86-4665-bbbe-ae00a9688e20" author="MineStar" failOnError="false">
        <preConditions onFailMessage="Ignored AddNotNullConstraint for TRANSPORTVEHICLE.NAME as column does not exist or is already not-nullable" onFail="MARK_RAN">
            <ext:columnIsNullable tableName="TRANSPORTVEHICLE" columnName="NAME"/>
        </preConditions>
        <comment>AHS-8409: AddNotNullConstraint to TRANSPORTVEHICLE.NAME</comment>
        <addNotNullConstraint columnName="NAME" columnDataType="VARCHAR(254)" tableName="TRANSPORTVEHICLE"/>
    </changeSet>

    <changeSet id="e7e139ae-0b5a-430e-948e-7d4c0fc96dff" author="MineStar" failOnError="false">
        <preConditions onFailMessage="Ignored AddNotNullConstraint for TRANSPORTVEHICLE.SEATS as column does not exist or is already not-nullable" onFail="MARK_RAN">
            <ext:columnIsNullable tableName="TRANSPORTVEHICLE" columnName="SEATS"/>
        </preConditions>
        <comment>AHS-8409: AddNotNullConstraint to TRANSPORTVEHICLE.SEATS</comment>
        <sql>UPDATE TRANSPORTVEHICLE SET SEATS = 0 WHERE SEATS IS NULL</sql>
        <addNotNullConstraint columnName="SEATS" columnDataType="INT" tableName="TRANSPORTVEHICLE"/>
        <rollback>
            <dropNotNullConstraint tableName="TRANSPORTVEHICLE" columnName="SEATS" columnDataType="INT"/>
        </rollback>
    </changeSet>

    <changeSet id="18d27f26-4598-4623-8bc3-1b5111927e8c" author="MineStar" failOnError="false">
        <preConditions onFailMessage="Ignored AddNotNullConstraint for TRANSPORTVEHICLE.DEDICATEDDRIVER as column does not exist or is already not-nullable" onFail="MARK_RAN">
            <ext:columnIsNullable tableName="TRANSPORTVEHICLE" columnName="DEDICATEDDRIVER"/>
        </preConditions>
        <comment>AHS-8409: AddNotNullConstraint to TRANSPORTVEHICLE.DEDICATEDDRIVER</comment>
        <sql>UPDATE TRANSPORTVEHICLE SET DEDICATEDDRIVER = 0 WHERE DEDICATEDDRIVER IS NULL</sql>
        <addNotNullConstraint columnName="DEDICATEDDRIVER" columnDataType="BOOLEAN" tableName="TRANSPORTVEHICLE"/>
        <rollback>
            <dropNotNullConstraint tableName="TRANSPORTVEHICLE" columnName="DEDICATEDDRIVER" columnDataType="BOOLEAN"/>
        </rollback>
    </changeSet>

    <changeSet id="b782990c-fe9e-4788-b3e5-df747205208e" author="MineStar" failOnError="false">
        <preConditions onFailMessage="Ignored AddNotNullConstraint for TRANSPORTVEHICLE.EXCLUDEFROMTRANSALLOCATION as column does not exist or is already not-nullable" onFail="MARK_RAN">
            <ext:columnIsNullable tableName="TRANSPORTVEHICLE" columnName="EXCLUDEFROMTRANSALLOCATION"/>
        </preConditions>
        <comment>AHS-8409: AddNotNullConstraint to TRANSPORTVEHICLE.EXCLUDEFROMTRANSALLOCATION</comment>
        <sql>UPDATE TRANSPORTVEHICLE SET EXCLUDEFROMTRANSALLOCATION = 0 WHERE EXCLUDEFROMTRANSALLOCATION IS NULL</sql>
        <addNotNullConstraint columnName="EXCLUDEFROMTRANSALLOCATION" columnDataType="BOOLEAN" tableName="TRANSPORTVEHICLE"/>
        <rollback>
            <dropNotNullConstraint tableName="TRANSPORTVEHICLE" columnName="EXCLUDEFROMTRANSALLOCATION" columnDataType="BOOLEAN"/>
        </rollback>
    </changeSet>

</databaseChangeLog>
