<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet id="15279d3c-21d6-4b3e-ab6f-5bc147c95e14" author="MineStar" failOnError="false">
        <preConditions onFailMessage="Ignored DropTable as tables don't exist." onFail="MARK_RAN">
            <tableExists tableName="BLEND_INFORMATION_RECORD"/>
            <tableExists tableName="DESTINATION_BLEND_DETAIL"/>
            <tableExists tableName="BLEND_DETAIL"/>
            <tableExists tableName="MATERIAL_CRITERIA_DETAIL"/>
            <tableExists tableName="DISCRETE_GRADE_CRITERIA_DETAIL"/>
            <tableExists tableName="CONT_GRADE_CRITERIA_DETAIL"/>
            <tableExists tableName="CURRENT_VALUE"/>
        </preConditions>
        <comment>4.6 Dropping tables until the requirements are stabilized</comment>
        <dropTable tableName="CONT_GRADE_CRITERIA_DETAIL" cascadeConstraints="true"/>
        <dropTable tableName="DISCRETE_GRADE_CRITERIA_DETAIL" cascadeConstraints="true"/>
        <dropTable tableName="MATERIAL_CRITERIA_DETAIL" cascadeConstraints="true"/>
        <dropTable tableName="BLEND_DETAIL" cascadeConstraints="true"/>
        <dropTable tableName="DESTINATION_BLEND_DETAIL" cascadeConstraints="true"/>
        <dropTable tableName="CURRENT_VALUE" cascadeConstraints="true"/>
        <dropTable tableName="BLEND_INFORMATION_RECORD" cascadeConstraints="true"/>
        <rollback/>
    </changeSet>


    <changeSet id="06df8b17-00c1-4d5f-be49-0dfcd8765e7a" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored CreateTable for BLEND_INFORMATION_RECORD as table already exists." onFail="MARK_RAN">
            <not>
                <tableExists tableName="BLEND_INFORMATION_RECORD"/>
            </not>
        </preConditions>
        <comment>4.6 CreateTable BLEND_INFORMATION_RECORD</comment>
        <createTable tablespace="MW_ENT" remarks="A destination blend information record" tableName="BLEND_INFORMATION_RECORD">
            <column name="OID" type="BIGINT" remarks="PK">
                <constraints nullable="false"/>
            </column>
            <column name="RECORD_TIME" type="DATETIME2" remarks="Timestamp of record">
                <constraints nullable="false"/>
            </column>
            <column name="CONTROL_MASS_MOVED" type="DOUBLE" remarks="The control mass moved"/>
            <column name="PROCESSOR_NAME" type="VARCHAR(1016)" remarks="The processor name"/>
            <column name="PROCESSOR_OID" type="BIGINT" remarks="Processor oid">
                <constraints nullable="false"/>
            </column>
            <column name="DESTINATION_BLEND_DETAIL_OID" type="BIGINT" remarks="Referenced destination blend detail">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addPrimaryKey columnNames="OID" constraintName="BLEND_INFORMATION_RECORD_PK" tablespace="MW_IDXENT" tableName="BLEND_INFORMATION_RECORD"/>
        <rollback/>
        <modifySql dbms="mssql,postgresql">
            <regExpReplace replace="( USING INDEX)? (ON|TABLESPACE) MW_[A-Z]+" with=""/>
        </modifySql>
    </changeSet>


    <changeSet id="4fe42c72-af50-4870-9b2d-09b8e705d5d8" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored CreateTable for DESTINATION_BLEND_DETAIL as table already exists." onFail="MARK_RAN">
            <not>
                <tableExists tableName="DESTINATION_BLEND_DETAIL"/>
            </not>
        </preConditions>
        <comment>4.6 CreateTable DESTINATION_BLEND_DETAIL</comment>
        <createTable tablespace="MW_ENT" remarks="A destination blend detail" tableName="DESTINATION_BLEND_DETAIL">
            <column name="OID" type="BIGINT" remarks="PK">
                <constraints nullable="false"/>
            </column>
            <column name="DESTINATION_BLEND_OID" type="BIGINT" remarks="Referenced destination blend oid in model schema">
                <constraints nullable="false"/>
            </column>
            <column name="DESTINATION_BLEND_DESCRIPTION" type="VARCHAR(255)" remarks="The destination blend description"/>
            <column name="BLEND_DETAIL_OID" type="BIGINT" remarks="reference to blend detail record">
                <constraints nullable="false"/>
            </column>
            <column name="MINIMUM_RATE" type="DOUBLE" remarks="The minimum rate"/>
            <column name="MAXIMUM_RATE" type="DOUBLE" remarks="The maximum rate"/>
            <column name="DESTINATION_BLEND_STATUS" type="VARCHAR(255)" remarks="Blend information record status, CREATED|MODIFIED|DELETED">
                <constraints nullable="false"/>
            </column>
            <column name="START_DATE" type="DATETIME2" remarks="Date time destination blend started">
                <constraints nullable="true"/>
            </column>
            <column name="END_DATE" type="DATETIME2" remarks="Date time destination blend ended">
                <constraints nullable="true"/>
            </column>
        </createTable>
        <addPrimaryKey columnNames="OID" constraintName="DESTINATION_BLEND_DETAIL_PK" tablespace="MW_IDXENT" tableName="DESTINATION_BLEND_DETAIL"/>
        <rollback/>
        <modifySql dbms="mssql,postgresql">
            <regExpReplace replace="( USING INDEX)? (ON|TABLESPACE) MW_[A-Z]+" with=""/>
        </modifySql>
    </changeSet>

    <changeSet id="06c941fe-6991-438e-910f-1351deb63e6a" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored AddForeignKeyConstraint for BLD_INF_REC_DST_BLD_DTL_FK to table BLEND_INFORMATION_RECORD as (1) the table does not exist, or (2) the foreignKey already exists." onFail="MARK_RAN">
            <tableExists tableName="BLEND_INFORMATION_RECORD"/>
            <tableExists tableName="DESTINATION_BLEND_DETAIL"/>
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="DESTINATION_BLEND_DETAIL" foreignKeyName="BLD_INF_REC_DST_BLD_DTL_FK"/>
            </not>
        </preConditions>
        <comment>4.6 AddForeignKeyConstraint BLD_INF_REC_DST_BLD_DTL_FK to BLEND_INFORMATION_RECORD (DESTINATION_BLEND_DETAIL_OID)</comment>
        <addForeignKeyConstraint baseTableName="BLEND_INFORMATION_RECORD" baseColumnNames="DESTINATION_BLEND_DETAIL_OID" constraintName="BLD_INF_REC_DST_BLD_DTL_FK" referencedTableName="DESTINATION_BLEND_DETAIL" referencedColumnNames="OID" deleteCascade="false"/>
    </changeSet>

    <changeSet id="6b877b2f-b689-4ab9-b76e-9162ed29b880" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored CreateTable for CURRENT_VALUE as table already exists." onFail="MARK_RAN">
            <not>
                <tableExists tableName="CURRENT_VALUE"/>
            </not>
        </preConditions>
        <comment>4.6 CreateTable CURRENT_VALUE</comment>
        <createTable tablespace="MW_ENT" remarks="A current value" tableName="CURRENT_VALUE">
            <column name="OID" type="BIGINT" remarks="PK">
                <constraints nullable="false"/>
            </column>
            <column name="REFERENCE_OID" type="BIGINT" remarks="referenced material | grade in model schema">
                <constraints nullable="false"/>
            </column>
            <column name="NAME" type="VARCHAR(1016)" remarks="name of referenced material | grade">
                <constraints nullable="false"/>
            </column>
            <column name="GRADE_VALUE" type="DOUBLE" remarks="magnitude of grade value">
                <constraints nullable="false"/>
            </column>
            <column name="GRADE_VAL_UNIT_TYPE" type="VARCHAR(254)" remarks="Grade value  of referenced grade unit type">
                <constraints nullable="true"/>
            </column>
            <column name="GRADE_VAL_UNIT_NAME" type="VARCHAR(254)" remarks="Grade value  of referenced grade unit name">
                <constraints nullable="true"/>
            </column>
            <column name="WEIGHTING" type="VARCHAR(255)" remarks="Blend computation method used">
                <constraints nullable="false"/>
            </column>
            <column name="WEIGHT_QTY" type="DOUBLE" remarks="Weighting quantity of referenced grade">
                <constraints nullable="false"/>
            </column>
            <column name="WEIGHT_QTY_UNIT_TYPE" type="VARCHAR(254)" remarks="Weighting quantity of referenced grade unit type">
                <constraints nullable="true"/>
            </column>
            <column name="WEIGHT_QTY_UNIT_NAME" type="VARCHAR(254)" remarks="Weighting quantity of referenced grade unit name">
                <constraints nullable="true"/>
            </column>
            <column name="GRADE_QTY" type="DOUBLE" remarks="Grade quantity amount">
                <constraints nullable="false"/>
            </column>
            <column name="VALUE_DESCRIMINATOR" type="VARCHAR(255)" remarks="discriminates rows between the 3 CurrentValue types">
                <constraints nullable="false"/>
            </column>
            <column name="BLEND_INFORMATION_RECORD_OID" type="BIGINT" remarks="referenced blend information record">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addPrimaryKey columnNames="OID" constraintName="CURRENT_VALUE_PK" tablespace="MW_IDXENT" tableName="CURRENT_VALUE"/>
        <rollback/>
        <modifySql dbms="mssql,postgresql">
            <regExpReplace replace="( USING INDEX)? (ON|TABLESPACE) MW_[A-Z]+" with=""/>
        </modifySql>
    </changeSet>

    <changeSet id="2c4ea1eb-288c-44bc-8a3a-b9a724a0c8ed" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored CreateTable for BLEND_DETAIL as table already exists." onFail="MARK_RAN">
            <not>
                <tableExists tableName="BLEND_DETAIL"/>
            </not>
        </preConditions>
        <comment>4.6 CreateTable BLEND_DETAIL</comment>
        <createTable tablespace="MW_ENT" remarks="A blend detail" tableName="BLEND_DETAIL">
            <column name="OID" type="BIGINT" remarks="PK">
                <constraints nullable="false"/>
            </column>
            <column name="BLEND_OID" type="BIGINT" remarks="Referenced blend in model schema">
                <constraints nullable="false"/>
            </column>
            <column name="BLEND_NAME" type="VARCHAR(1016)" remarks="Name of blend">
                <constraints nullable="true"/>
            </column>
            <column name="BLEND_METHOD" type="VARCHAR(255)" remarks="Blend computation method used">
                <constraints nullable="true"/>
            </column>
            <column name="CONTROL_MASS" type="DOUBLE" remarks="The control mass"/>
            <column name="CONTROL_DURATION" type="DOUBLE" remarks="The control duration"/>
        </createTable>
        <addPrimaryKey columnNames="OID" constraintName="BLEND_DETAIL_PK" tablespace="MW_IDXENT" tableName="BLEND_DETAIL"/>
        <rollback/>
        <modifySql dbms="mssql,postgresql">
            <regExpReplace replace="( USING INDEX)? (ON|TABLESPACE) MW_[A-Z]+" with=""/>
        </modifySql>
    </changeSet>

    <changeSet id="6c0bd301-5f13-4804-a58c-12dd92f78df5" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored CreateTable for MATERIAL_CRITERIA_DETAIL as table already exists." onFail="MARK_RAN">
            <not>
                <tableExists tableName="MATERIAL_CRITERIA_DETAIL"/>
            </not>
        </preConditions>
        <comment>4.6 CreateTable MATERIAL_CRITERIA_DETAIL</comment>
        <createTable tablespace="MW_ENT" remarks="A destination blend detail" tableName="MATERIAL_CRITERIA_DETAIL">
            <column name="OID" type="BIGINT" remarks="PK">
                <constraints nullable="false"/>
            </column>
            <column name="BLEND_DETAIL_OID" type="BIGINT" remarks="Referenced blend detail">
                <constraints nullable="false"/>
            </column>
            <column name="MATERIAL_NAME" type="VARCHAR(1016)" remarks="Name of referenced material">
                <constraints nullable="true"/>
            </column>
            <column name="MINIMUM_VALUE" type="DOUBLE" remarks="The minimum value">
                <constraints nullable="true"/>
            </column>
            <column name="MAXIMUM_VALUE" type="DOUBLE" remarks="The maximum value">
                <constraints nullable="true"/>
            </column>
            <column name="LOWER_LIMIT" type="DOUBLE" remarks="The lower limit">
                <constraints nullable="true"/>
            </column>
            <column name="UPPER_LIMIT" type="DOUBLE" remarks="The upper limit">
                <constraints nullable="true"/>
            </column>

        </createTable>
        <addPrimaryKey columnNames="OID" constraintName="MATERIAL_CRITERIA_DETAIL_PK" tablespace="MW_IDXENT" tableName="MATERIAL_CRITERIA_DETAIL"/>
        <rollback/>
        <modifySql dbms="mssql,postgresql">
            <regExpReplace replace="( USING INDEX)? (ON|TABLESPACE) MW_[A-Z]+" with=""/>
        </modifySql>
    </changeSet>

    <changeSet id="6dc5afe2-2f1f-4e3b-94c2-1329771bc5f1" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored AddForeignKeyConstraint for to table MATERIAL_CRITERIA_DETAIL as (1) the table does not exist, or (2) the foreignKey already exists." onFail="MARK_RAN">
            <tableExists tableName="BLEND_DETAIL"/>
            <tableExists tableName="MATERIAL_CRITERIA_DETAIL"/>
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="MATERIAL_CRITERIA_DETAIL" foreignKeyName="MAT_CRIT_BLD_DET_FK"/>
            </not>
        </preConditions>
        <comment>4.6 AddForeignKeyConstraint MAT_CRIT_BLD_DET_FK to MATERIAL_CRITERIA_DETAIL (BLEND_DETAIL_OID)</comment>
        <addForeignKeyConstraint baseTableName="MATERIAL_CRITERIA_DETAIL" baseColumnNames="BLEND_DETAIL_OID" constraintName="MAT_CRIT_BLD_DET_FK" referencedTableName="BLEND_DETAIL" referencedColumnNames="OID" deleteCascade="false"/>
    </changeSet>

    <changeSet id="f7b4e15c-0bee-4296-aa07-a8c1444f46d2" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored AddForeignKeyConstraint for to table DESTINATION_BLEND_DETAIL as (1) the table does not exist, or (2) the foreignKey already exists." onFail="MARK_RAN">
            <tableExists tableName="BLEND_DETAIL"/>
            <tableExists tableName="DESTINATION_BLEND_DETAIL"/>
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="DESTINATION_BLEND_DETAIL" foreignKeyName="DEST_BLD_DTL_BLD_DET_FK"/>
            </not>
        </preConditions>
        <comment>4.6 AddForeignKeyConstraint DEST_BLD_DTL_BLD_DET_FK to DESTINATION_BLEND_DETAIL (BLEND_DETAIL_OID)</comment>
        <addForeignKeyConstraint baseTableName="DESTINATION_BLEND_DETAIL" baseColumnNames="BLEND_DETAIL_OID" constraintName="DEST_BLD_DTL_BLD_DET_FK" referencedTableName="BLEND_DETAIL" referencedColumnNames="OID" deleteCascade="false"/>
    </changeSet>

    <changeSet id="dced16fc-3626-4c92-9ec4-0b448d93b522" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored CreateTable for DISCRETE_GRADE_CRITERIA_DETAIL as table already exists." onFail="MARK_RAN">
            <not>
                <tableExists tableName="DISCRETE_GRADE_CRITERIA_DETAIL"/>
            </not>
        </preConditions>
        <comment>4.6 CreateTable DISCRETE_GRADE_CRITERIA_DETAIL</comment>
        <createTable tablespace="MW_ENT" remarks="A discrete grade criteria detail" tableName="DISCRETE_GRADE_CRITERIA_DETAIL">
            <column name="OID" type="BIGINT" remarks="PK">
                <constraints nullable="false"/>
            </column>
            <column name="BLEND_DETAIL_OID" type="BIGINT" remarks="Referenced blend detail">
                <constraints nullable="false"/>
            </column>
            <column name="GRADE_NAME" type="VARCHAR(1016)" remarks="Name of referenced grade">
                <constraints nullable="true"/>
            </column>
            <column name="GRADE_VALUE" type="VARCHAR(1016)" remarks="Grade value  of referenced grade">
                <constraints nullable="true"/>
            </column>
            <column name="MINIMUM_VALUE" type="DOUBLE" remarks="The minimum value">
                <constraints nullable="true"/>
            </column>
            <column name="MAXIMUM_VALUE" type="DOUBLE" remarks="The maximum value">
                <constraints nullable="true"/>
            </column>
            <column name="LOWER_LIMIT" type="DOUBLE" remarks="The lower limit">
                <constraints nullable="true"/>
            </column>
            <column name="UPPER_LIMIT" type="DOUBLE" remarks="The upper limit">
                <constraints nullable="true"/>
            </column>

        </createTable>
        <addPrimaryKey columnNames="OID" constraintName="DISCRETE_GRADE_CRITERIA_DET_PK" tablespace="MW_IDXENT" tableName="DISCRETE_GRADE_CRITERIA_DETAIL"/>
        <rollback/>
        <modifySql dbms="mssql,postgresql">
            <regExpReplace replace="( USING INDEX)? (ON|TABLESPACE) MW_[A-Z]+" with=""/>
        </modifySql>
    </changeSet>

    <changeSet id="f736cfc3-c61f-49aa-af4f-3ad449e92c14" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored AddForeignKeyConstraint for to table DISCRETE_GRADE_CRITERIA_DETAIL as (1) the table does not exist, or (2) the foreignKey already exists." onFail="MARK_RAN">
            <tableExists tableName="BLEND_DETAIL"/>
            <tableExists tableName="DISCRETE_GRADE_CRITERIA_DETAIL"/>
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="DISCRETE_GRADE_CRITERIA_DETAIL" foreignKeyName="DIS_GRD_CRIT_BLD_DET_FK"/>
            </not>
        </preConditions>
        <comment>4.6 AddForeignKeyConstraint DIS_GRD_CRIT_BLD_DET_FK to DISCRETE_GRADE_CRITERIA_DETAIL (BLEND_DETAIL_OID)</comment>
        <addForeignKeyConstraint baseTableName="DISCRETE_GRADE_CRITERIA_DETAIL" baseColumnNames="BLEND_DETAIL_OID" constraintName="DIS_GRD_CRIT_BLD_DET_FK" referencedTableName="BLEND_DETAIL" referencedColumnNames="OID" deleteCascade="false"/>
    </changeSet>

    <changeSet id="129ef15d-f5e1-4a2e-8f03-90b575a8a23d" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored CreateTable for CONT_GRADE_CRITERIA_DETAIL as table already exists." onFail="MARK_RAN">
            <not>
                <tableExists tableName="CONT_GRADE_CRITERIA_DETAIL"/>
            </not>
        </preConditions>
        <comment>4.6 CreateTable CONT_GRADE_CRITERIA_DETAIL</comment>
        <createTable tablespace="MW_ENT" remarks="A continuous grade criteria detail" tableName="CONT_GRADE_CRITERIA_DETAIL">
            <column name="OID" type="BIGINT" remarks="PK">
                <constraints nullable="false"/>
            </column>
            <column name="BLEND_DETAIL_OID" type="BIGINT" remarks="Referenced blend detail">
                <constraints nullable="false"/>
            </column>
            <column name="GRADE_NAME" type="VARCHAR(1016)" remarks="Name of referenced grade">
                <constraints nullable="true"/>
            </column>
            <column name="UNIT_TYPE" type="VARCHAR(254)" remarks="Grade value  of referenced grade">
                <constraints nullable="true"/>
            </column>
            <column name="UNIT_NAME" type="VARCHAR(254)" remarks="Grade value  of referenced grade">
                <constraints nullable="true"/>
            </column>
            <column name="MINIMUM_VALUE" type="DOUBLE" remarks="The minimum value">
                <constraints nullable="true"/>
            </column>
            <column name="MAXIMUM_VALUE" type="DOUBLE" remarks="The maximum value">
                <constraints nullable="true"/>
            </column>
            <column name="LOWER_LIMIT" type="DOUBLE" remarks="The lower limit">
                <constraints nullable="true"/>
            </column>
            <column name="UPPER_LIMIT" type="DOUBLE" remarks="The upper limit">
                <constraints nullable="true"/>
            </column>

        </createTable>
        <addPrimaryKey columnNames="OID" constraintName="CONT_GRADE_CRITERIA_DETAIL_PK" tablespace="MW_IDXENT" tableName="CONT_GRADE_CRITERIA_DETAIL"/>
        <rollback/>
        <modifySql dbms="mssql,postgresql">
            <regExpReplace replace="( USING INDEX)? (ON|TABLESPACE) MW_[A-Z]+" with=""/>
        </modifySql>
    </changeSet>

    <changeSet id="fba3f803-471e-447c-b698-1a50f311b8d3" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored AddForeignKeyConstraint for to table CONTINUOUS_GRADE_CRITERIA_DETAIL as (1) the table does not exist, or (2) the foreignKey already exists." onFail="MARK_RAN">
            <tableExists tableName="BLEND_DETAIL"/>
            <tableExists tableName="CONT_GRADE_CRITERIA_DETAIL"/>
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="CONT_GRADE_CRITERIA_DETAIL" foreignKeyName="CON_GRD_CRIT_BLD_DET_FK"/>
            </not>
        </preConditions>
        <comment>4.6 AddForeignKeyConstraint CON_GRD_CRIT_BLD_DET_FK to CONT_GRADE_CRITERIA_DETAIL (BLEND_DETAIL_OID)</comment>
        <addForeignKeyConstraint baseTableName="CONT_GRADE_CRITERIA_DETAIL" baseColumnNames="BLEND_DETAIL_OID" constraintName="CON_GRD_CRIT_BLD_DET_FK" referencedTableName="BLEND_DETAIL" referencedColumnNames="OID" deleteCascade="false"/>
    </changeSet>

    <changeSet id="2521a24a-93ad-4872-a03e-892ca724ae1f" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored AddForeignKeyConstraint for to table CURRENT_VALUE as (1) the table does not exist, or (2) the foreignKey already exists." onFail="MARK_RAN">
            <tableExists tableName="BLEND_INFORMATION_RECORD"/>
            <tableExists tableName="CURRENT_VALUE"/>
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="CURRENT_VALUE" foreignKeyName="CURRENT_VALUE_BLND_INFO_REC_FK"/>
            </not>
        </preConditions>
        <comment>4.6 AddForeignKeyConstraint CURRENT_VALUE_BLND_INFO_REC_FK to CURRENT_VALUE (BLEND_INFORMATION_RECORD_OID)</comment>
        <addForeignKeyConstraint baseTableName="CURRENT_VALUE" baseColumnNames="BLEND_INFORMATION_RECORD_OID" constraintName="CURRENT_VALUE_BLND_INFO_REC_FK" referencedTableName="BLEND_INFORMATION_RECORD" referencedColumnNames="OID" deleteCascade="false"/>
    </changeSet>

    <changeSet id="86d9e8d6-180d-49f8-864b-afb21a06e415" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored CreateTable for DEST_BLEND_PROCESSOR_DETAIL as table already exists." onFail="MARK_RAN">
            <not>
                <tableExists tableName="DEST_BLEND_PROCESSOR_DETAIL"/>
            </not>
        </preConditions>
        <comment>4.6 CreateTable DEST_BLEND_PROCESSOR_DETAIL</comment>
        <createTable tablespace="MW_ENT" remarks="The list of processors at the time of the destination blend" tableName="DEST_BLEND_PROCESSOR_DETAIL">
            <column name="OID" type="BIGINT" remarks="PK">
                <constraints nullable="false"/>
            </column>
            <column name="DESTINATION_BLEND_DETAIL_OID" type="BIGINT" remarks="Destination blend detail oid">
                <constraints nullable="false"/>
            </column>
            <column name="PROCESSOR_OID" type="BIGINT" remarks="Processor">
                <constraints nullable="false"/>
            </column>
            <column name="PROCESSOR_NAME" type="VARCHAR(1016)" remarks="Name of referenced processor">
                <constraints nullable="true"/>
            </column>
        </createTable>
        <addPrimaryKey columnNames="OID" constraintName="DEST_BLEND_PROCESSOR_DETAIL_PK" tablespace="MW_IDXENT" tableName="DEST_BLEND_PROCESSOR_DETAIL"/>
        <rollback/>
        <modifySql dbms="mssql,postgresql">
            <regExpReplace replace="( USING INDEX)? (ON|TABLESPACE) MW_[A-Z]+" with=""/>
        </modifySql>
    </changeSet>

    <changeSet id="d79e163d-430d-4eb0-8812-6e117fdb50ba" author="MineStar" context="Material_Tracking/Material_Tracking_Management" failOnError="false">
        <preConditions onFailMessage="Ignored AddForeignKeyConstraint for DST_BLD_PRC_DET_DST_BLD_DET_FK to table DEST_BLEND_PROCESSOR_DETAIL as (1) the table does not exist, or (2) the foreignKey already exists." onFail="MARK_RAN">
            <tableExists tableName="DEST_BLEND_PROCESSOR_DETAIL"/>
            <tableExists tableName="DESTINATION_BLEND_DETAIL"/>
            <not>
                <foreignKeyConstraintExists foreignKeyTableName="DEST_BLEND_PROCESSOR_DETAIL" foreignKeyName="DST_BLD_PRC_DET_DST_BLD_DET_FK"/>
            </not>
        </preConditions>
        <comment>4.6 AddForeignKeyConstraint DST_BLD_PRC_DET_DST_BLD_DET_FK to DEST_BLEND_PROCESSOR_DETAIL (DESTINATION_BLEND_DETAIL_OID)</comment>
        <addForeignKeyConstraint baseTableName="DEST_BLEND_PROCESSOR_DETAIL" baseColumnNames="DESTINATION_BLEND_DETAIL_OID" constraintName="DST_BLD_PRC_DET_DST_BLD_DET_FK" referencedTableName="DESTINATION_BLEND_DETAIL" referencedColumnNames="OID" deleteCascade="false"/>
    </changeSet>

    <changeSet id="80eea648-e901-4be8-8bed-9381e045590a" author="MineStar" failOnError="false">
        <preConditions onFailMessage="Ignored AddColumn for VALUE_DESCRIPTION to table CURRENT_VALUE as table does not exist or column already exists." onFail="MARK_RAN">
            <tableExists tableName="CURRENT_VALUE"/>
            <not>
                <columnExists tableName="CURRENT_VALUE" columnName="VALUE_DESCRIPTION"/>
            </not>
        </preConditions>
        <comment>4.6 AddColumn CURRENT_VALUE.VALUE_DESCRIPTION</comment>
        <addColumn tableName="CURRENT_VALUE">
            <column name="VALUE_DESCRIPTION" type="VARCHAR(1016)" remarks="Value description for Discrete grades">
                <constraints nullable="true"/>
            </column>
        </addColumn>
    </changeSet>

</databaseChangeLog>
