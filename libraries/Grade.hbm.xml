<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping default-access="field" schema="model">

    <class name="minestar.production.domain.grade.AbstractGrade"
           table="GRADE"
           discriminator-value="XAEntity.Grade">

        <meta attribute="table">
            tablespace=MW_ENT
        </meta>
        <meta attribute="primary-key">
            tablespace=MW_IDXENT
        </meta>
        <meta attribute="index">
            name=GRADE_NAME
            unique=true
            columns=NAME
            tablespace=MW_IDXENT
        </meta>

        <meta attribute="description">Information used to describe a material.</meta>

        <cache usage="read-write" region="model"/>

        <id name="OID" type="long" column="GRADE_OID">
            <generator class="com.mincom.env.base.persistence.IDGenerator"/>
        </id>

        <discriminator column="ECF_CLASS_ID" not-null="true"/>

        <property name="active" type="boolean" column="IS_ACTIVE" not-null="true">
            <meta attribute="description">Is this grade active</meta>
        </property>

        <property name="id" type="long" column="ID">
            <meta attribute="description">A unique identifier of the grade.</meta>
            <meta attribute="universe-type-measure">false</meta>
        </property>

        <property name="name" type="string" column="NAME" length="254" not-null="true">
            <meta attribute="description">The name of the grade.</meta>
        </property>

        <property name="author" type="string" column="AUTHOR" length="254">
            <meta attribute="description">The author of the grade.</meta>
        </property>

        <property name="averageMethod" type="minestar.mine.domain.material.WeightingMethodEnumUserType" column="AVERAGEMETHOD" length="254">
            <meta attribute="description">The method by which the grade values are calculates when
                quantities of this grade are combined - possible values [mass, volume]
            </meta>
        </property>

        <property name="unitType" type="string" column="UNITTYPE" length="254">
            <meta attribute="description">The unit type that all values of this grade will use.</meta>
        </property>

        <property name="unitName" type="string" column="UNITNAME" length="254">
            <meta attribute="description">The unit that all values of this grade will use.</meta>
        </property>

        <property name="externalRef" type="string" column="EXTERNALREF" length="254">
            <meta attribute="description">The external system reference of this grade</meta>
        </property>

        <property name="externalDesc" type="string" column="EXTERNALDESC" length="254">
            <meta attribute="description">The External System Description</meta>
        </property>

        <!-- subclasses -->

        <subclass name="minestar.production.domain.grade.ContinuousGrade"
                  discriminator-value="XAEntity.Grade.ContinuousGrade">
            <meta attribute="description">A grade with numerical value over a continuum.</meta>

            <property name="valueCont" type="double" column="VALUECONT">
                <meta attribute="description">The value of the grade.</meta>
                <meta attribute="unitType">unitless</meta>
                <meta attribute="quantity">unitType,unitName</meta>
            </property>
            <property name="maximumValue" type="double" column="MAXIMUMVALUE">
                <meta attribute="description">The maximum value of the grade.</meta>
                <meta attribute="unitType">unitless</meta>
                <meta attribute="quantity">unitType,unitName</meta>
            </property>
            <property name="minimumValue" type="double" column="MINIMUMVALUE">
                <meta attribute="description">The lowest value of the grade.</meta>
                <meta attribute="unitType">unitless</meta>
                <meta attribute="quantity">unitType,unitName</meta>
            </property>
            <property name="desiredValueCont" type="double" column="DESIREDVALUECONT">
                <meta attribute="description">The desired value of the grade.</meta>
                <meta attribute="unitType">unitless</meta>
                <meta attribute="quantity">unitType,unitName</meta>
            </property>

        </subclass>

        <subclass name="minestar.production.domain.grade.DiscreteGrade"
                  discriminator-value="XAEntity.Grade.DiscreteGrade">
            <meta attribute="description">A grade with distinct and unique values.</meta>

            <property name="valueDisc" type="string" column="VALUEDISC" length="254">
                <meta attribute="description">The discrete value of the grade.</meta>
            </property>

            <property name="desiredValueDisc" type="string" column="DESIREDVALUEDISC" length="254">
                <meta attribute="description">The desired value of the grade.</meta>
            </property>

            <list name="valueList" table="GRADE_DISCRETE_VALUE">
                <meta attribute="collection-table">
                    tablespace=MW_ENT
                </meta>
                <meta attribute="collection-primary-key">
                    tablespace=MW_IDXENT
                </meta>
                <meta attribute="description">A list of all allowable values of this grade.</meta>
                <meta attribute="index-alias">nr</meta>
                <key column="OID" not-null="true"/>
                <list-index column="NR"/>
                <element type="string" column="VALUE" not-null="true"/>
            </list>

        </subclass>

    </class>

    <!-- A lightweight reference to a Grade -->
    <class name="minestar.production.domain.grade.GradeReference" table="GRADE" mutable="false" lazy="false">

        <meta attribute="alias" inherit="false">GRADE_REFERENCE</meta>
        <meta attribute="description">A minimal reference to a grade.</meta>
        <meta attribute="view-create-order">1</meta>
        <meta attribute="view-master">true</meta>

        <cache usage="read-only" region="model"/>

        <id name="OID" type="long" column="GRADE_OID"/>
        <property name="name" type="string" column="NAME" length="254" not-null="true"/>

    </class>
    
</hibernate-mapping>
