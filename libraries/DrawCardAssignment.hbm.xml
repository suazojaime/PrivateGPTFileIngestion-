<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping default-access="field" schema="model">

    <class name="minestar.production.domain.drawcard.DrawCardAssignmentImpl"
           proxy="minestar.production.domain.drawcard.DrawCardAssignment"
           table="DRAW_CARD_ASSIGNMENT"
           dynamic-update="true">

        <meta attribute="alias" inherit="false">DrawCardAssignment</meta>
        <meta attribute="description">
            The details of the underground areas that machines are currently assigned to and operating in.
        </meta>
        <meta attribute="table">
            tablespace=MW_ENT
        </meta>
        <meta attribute="primary-key">
            tablespace=MW_IDXENT
        </meta>

        <cache usage="read-write" region="model"/>

        <id name="OID"
            type="java.lang.Long"
            column="DCA_OID">
            <generator class="com.mincom.env.base.persistence.IDGenerator"/>
        </id>

        <many-to-one name="machine"
                     class="minestar.pitlink.domain.machine.MachineReference"
                     column="MACHINE"
                     unique="true"
                     not-null="true">
            <meta attribute="description">
                A reference to the machine (MSMODEL.MACHINE) that this record applies to.
            </meta>
        </many-to-one>

        <many-to-one name="assignedArea"
                     class="minestar.mine.domain.minemodel.underground.area.UndergroundAreaReference"
                     column="ASSIGNED_AREA">
            <meta attribute="description">
                A reference to the underground area (MSMODEL.UNDERGROUND_AREA) that the machine is currently assigned
                to when the machine is assigned to a real area.
            </meta>
        </many-to-one>

        <many-to-one name="assignedJoinedArea"
                     class="minestar.mine.domain.minemodel.underground.area.JoinedUndergroundAreaReference"
                     column="ASSIGNED_JOINED_AREA">
            <meta attribute="description">
                A reference to the underground area (MSMODEL.JOINED_UNDERGROUND_AREA) that the machine is currently assigned
                to when the machine is assigned to a joined area.
            </meta>
        </many-to-one>

        <property name="assignedTimestamp"
                  type="TimestampType"
                  column="ASSIGNED_TIMESTAMP_UTC">
            <meta attribute="timestamp">true</meta>
            <meta attribute="description">
                The timestamp of when the machine was assigned to its underground area.
            </meta>
            <meta attribute="utc-description">
                The UTC timestamp of when the machine was assigned to its underground area.
            </meta>
        </property>

        <many-to-one name="servicingArea"
                     class="minestar.mine.domain.minemodel.underground.area.UndergroundAreaReference"
                     column="SERVICING_AREA">
            <meta attribute="description">
                A reference to the underground area (MSMODEL.UNDERGROUND_AREA) that the machine is currently operating
                in.
            </meta>
        </many-to-one>

        <property name="servicingTimestamp"
                  type="TimestampType"
                  column="SERVICING_TIMESTAMP_UTC">
            <meta attribute="timestamp">true</meta>
            <meta attribute="description">
                The timestamp of when the machine was last known to be operating in its servicing area.
            </meta>
            <meta attribute="utc-description">
                The UTC timestamp of when the machine was last known to be operating in its servicing area.
            </meta>
        </property>

        <property name="sendAssignmentMessageSuccess"
                  type="java.lang.Boolean"
                  column="SEND_MESSAGE_SUCCESS">
            <meta attribute="description">
                Whether the last attempt to send a DrawCardAssignment message to the machine was successful. This field
                only applies to manned LHDs.
                (This flag is '1' if it was successful, '0' if it failed, and null if no attempt was made.)
            </meta>
        </property>

    </class>

</hibernate-mapping>
