<?xml version="1.0"?><!-- Copyright (c) 2020 Caterpillar -->

<!DOCTYPE Configure PUBLIC "-//Jetty//Configure//EN"
        "http://www.eclipse.org/jetty/configure_9_3.dtd">

<Configure id="Server" class="org.eclipse.jetty.server.Server">

    <!-- =========================================================== -->
    <!-- configure rewrite handler                                   -->
    <!-- =========================================================== -->
    <Call name="insertHandler">
        <Arg>
            <New class="org.eclipse.jetty.rewrite.handler.RewriteHandler">
                <Set name="rewriteRequestURI">
                    <Property name="jetty.rewrite.rewriteRequestURI" deprecated="rewrite.rewriteRequestURI"
                              default="true"/>
                </Set>
                <Set name="rewritePathInfo">
                    <Property name="jetty.rewrite.rewritePathInfo" deprecated="rewrite.rewritePathInfo"
                              default="false"/>
                </Set>
                <Set name="originalPathAttribute">
                    <Property name="jetty.rewrite.originalPathAttribute" deprecated="rewrite.originalPathAttribute"
                              default="requestedPath"/>
                </Set>

                <Set name="rules">
                    <Array type="org.eclipse.jetty.rewrite.handler.Rule">
                        <Item>
                            <New id="header" class="org.eclipse.jetty.rewrite.handler.HeaderPatternRule">
                                <Set name="pattern">*</Set>
                                <Set name="name">X-XSS-Protection</Set>
                                <Set name="value">1; mode=block</Set>
                            </New>
                        </Item>
                        <Item>
                            <New id="header" class="org.eclipse.jetty.rewrite.handler.HeaderPatternRule">
                                <Set name="pattern">*</Set>
                                <Set name="name">X-Content-Type-Options</Set>
                                <Set name="value">nosniff</Set>
                            </New>
                        </Item>
                        <Item>
                            <New id="header" class="org.eclipse.jetty.rewrite.handler.HeaderPatternRule">
                                <Set name="pattern">*</Set>
                                <Set name="name">Content-Security-Policy</Set>
                                <Set name="value">script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline'
                                </Set>
                            </New>
                        </Item>
                        <Item>
                            <New id="header" class="org.eclipse.jetty.rewrite.handler.HeaderPatternRule">
                                <Set name="pattern">*</Set>
                                <Set name="name">X-Frame-Options</Set>
                                <Set name="value">SAMEORIGIN</Set>
                            </New>
                        </Item>

                        <Item>
                            <New id="header" class="org.eclipse.jetty.rewrite.handler.HeaderPatternRule">
                                <Set name="pattern">/minestar/sats/index.html</Set>
                                <Set name="name">X-Frame-Options</Set>
                                <Set name="value"></Set>
                            </New>
                        </Item>
                        
<!--                        <Item>-->
<!--                            <New id="header" class="org.eclipse.jetty.rewrite.handler.HeaderPatternRule">-->
<!--                                <Set name="pattern">*</Set>-->
<!--                                <Set name="name">Strict-Transport-Security</Set>-->
<!--                                <Set name="value">max-age=31536000;includeSubDomains</Set>-->
<!--                            </New>-->
<!--                        </Item>-->
                    </Array>
                </Set>

                <!-- Set DispatcherTypes  -->
                <Set name="dispatcherTypes">
                    <Array type="javax.servlet.DispatcherType">
                        <Item>
                            <Call class="javax.servlet.DispatcherType" name="valueOf">
                                <Arg>REQUEST</Arg>
                            </Call>
                        </Item>
                        <Item>
                            <Call class="javax.servlet.DispatcherType" name="valueOf">
                                <Arg>ASYNC</Arg>
                            </Call>
                        </Item>
                    </Array>
                </Set>

                <Get id="Rewrite" name="ruleContainer"/>

                <!-- see rewrite-compactpath.xml for example how to add a rule -->

            </New>
        </Arg>
    </Call>
</Configure>
