<?xml version="1.0" encoding="UTF-8"?>

<!-- Copyright (c) 2021 Caterpillar -->
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="
            http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        ">

    <bean id="modeControlServiceImpl"
          class="minestar.autonomy.service.mode.core.DelegatingModeControlService">
        <constructor-arg name="mineFleetService" ref="mineFleetServiceImpl"/>
    </bean>

    <bean id="registerModeControlService" parent="registrationInstance" lazy-init="true">
        <constructor-arg value="Mode Control Service"/>
        <constructor-arg value="minestar.autonomy.service.mode.ModeControlService"/>
        <constructor-arg ref="modeControlServiceImpl"/>
    </bean>

    <bean id="sharedModeControlService"
          class="minestar.mode.shared.SharedModeControlService">
        <constructor-arg name="processModeStatus" ref="sharedProcessModeStatus"/>
        <constructor-arg name="armMachine" ref="sharedArmMachine"/>
        <constructor-arg name="updateMachineMode" ref="sharedUpdateMachineMode"/>
        <constructor-arg name="processAutoArmedRequest" ref="sharedProcessAutoArmedRequest"/>
    </bean>

    <bean id="sharedProcessModeStatus"
          class="minestar.mode.shared.control.ProcessModeStatus">
        <constructor-arg name="machineDiagnosticsService" ref="machineDiagnosticsServiceImpl"/>
        <constructor-arg name="machineModeService" ref="machineModeServiceImpl"/>
        <constructor-arg name="modeControlService" ref="modeControlServiceImpl"/>
        <constructor-arg name="modeEventHandler" ref="modeEventHandler"/>
    </bean>

    <bean id="sharedProcessAutoArmedRequest"
          class="minestar.mode.shared.control.ProcessAutoArmedRequest">
        <constructor-arg name="modeControlService" ref="modeControlServiceImpl"/>
        <constructor-arg name="modeMessageService" ref="modeMessageServiceImpl"/>
    </bean>

    <bean id="sharedArmMachine"
          class="minestar.mode.shared.control.ArmMachine">
        <constructor-arg name="machineModeService" ref="machineModeServiceImpl"/>
        <constructor-arg name="modeEventHandler" ref="modeEventHandler"/>
        <constructor-arg name="userService" ref="userServiceImpl"/>
    </bean>

    <bean id="sharedUpdateMachineMode"
          class="minestar.mode.shared.control.UpdateMachineMode">
        <constructor-arg name="auditLogger" ref="auditLogger"/>
        <constructor-arg name="machineModeService" ref="machineModeServiceImpl"/>
        <constructor-arg name="mineFleetService" ref="mineFleetServiceImpl"/>
        <constructor-arg name="modeUsageLocks" ref="modeUsageLocks"/>
        <constructor-arg name="modeEventHandler" ref="modeEventHandler"/>
        <constructor-arg name="assignmentRequestService" ref="assignmentRequestServiceImpl"/>
    </bean>

    <bean id="machineModeChangeServiceImpl" class="minestar.mode.service.impl.MachineModeChangeServiceImpl" lazy-init="true">
        <property name="machineModeChangeDao" ref="machineModeChangeDaoImpl"/>
    </bean>

</beans>
