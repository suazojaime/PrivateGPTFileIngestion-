<?xml version="1.0"?>
<!-- Copyright (c) 2019 Caterpillar -->

<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping schema="model">

	<class name="minestar.health.api.definition.SystemPollingConfig" table="SYSTEM_POLLING" dynamic-update="true">

       <meta attribute="view-include">false</meta>
       <meta attribute="view-ignore">true</meta>
       <meta attribute="foreign-key">on-delete=CASCADE</meta>
	   <id name="oid" type="long">
		    <column name="OID" />
		    <generator class="increment" />
	    </id>

       <many-to-one name="machine" class="minestar.pitlink.domain.machine.MachineReference" column="MACHINE_OID" not-null="true" unique-key="config_unique" cascade="none"/>

	   <property name="type" not-null="true" unique-key="config_unique">
	      <type name="org.hibernate.type.EnumType">
	         <param name="enumClass">minestar.health.api.definition.MeasureGroupType</param>
	      </type>
	   </property>
	   
		<set name="measures" table="SYSTEM_POLLING_MEASURES" lazy="true" fetch="select">
            <key>
                <column name="CONFIG_OID" not-null="true" />
            </key>
            <many-to-many entity-name="minestar.health.api.definition.Measure">
                <column name="MEASURE_OID" not-null="true" />
            </many-to-many>
        </set>
	</class>
</hibernate-mapping>
