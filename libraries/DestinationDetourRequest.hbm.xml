<?xml version="1.0"?>
<!--
  ~ Copyright (c) 2022 Caterpillar
  -->

<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping default-access="field" default-lazy="false" schema="pitmodel">

    <class name="minestar.pitlink.domain.detour.DestinationDetourRequest" table="DETOUR_REQUEST">

        <meta attribute="description">
            Request for a truck to be re-routed through a detour like a payload service (e.g. weigh bridge, oversize
            gantry) on the way to its destination like a loading tool or processor.
        </meta>

        <id name="OID" type="long" column="TRUCK_OID">
            <!-- Equals Truck.OID -->
            <generator class="assigned"/>
        </id>

        <many-to-one name="truck"
                     class="minestar.pitlink.domain.machine.MachineReference"
                     formula="TRUCK_OID"
                     not-null="true">
            <meta attribute="description">
                Reference to truck that this detour request applies to
            </meta>
        </many-to-one>

        <property name="detourDestinationType"
                  type="minestar.domain.model.persistence.DetourDestinationUserType"
                  column="DESTINATION_TYPE"
                  not-null="true">
            <meta attribute="description">
                Type of detour destination that the truck should go through
            </meta>
        </property>

        <property name="whenCondition"
                  type="minestar.domain.model.persistence.DetourRequestConditionUserType">
            <meta attribute="description">
                When should the truck be routed via a detour destination
            </meta>
            <column name="CONDITION" default="0" not-null="true"/>
        </property>

        <many-to-one name="createdByUser"
                     class="minestar.platform.domain.user.UserReference"
                     column="CREATOR_OID"
                     not-null="false">
            <meta attribute="description">
                Reference to user that created this detour request, or null if created by Plan Management system
            </meta>
        </many-to-one>

    </class>

</hibernate-mapping>
