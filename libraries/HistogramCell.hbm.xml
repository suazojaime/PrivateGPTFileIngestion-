<?xml version="1.0"?>
<!-- Copyright (c) 2019 Caterpillar -->

<!DOCTYPE hibernate-mapping PUBLIC
        "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
        "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping package="minestar.health.domain.metadata" schema="model">

    <!-- minestar.health.domain.metadata.HistogramCell root -->
    <class name="HistogramCellDef" table="HIST_CELL_DEF">
        <meta attribute="noDatabaseMetadata" inherit="false">true</meta>

        <meta attribute="table">
            tablespace=MW_OBJ
        </meta>
        <meta attribute="primary-key">
            tablespace=MW_IDXOBJ
        </meta>

        <meta attribute="viewproperty-label" inherit="false">
            type=string
            expression=lookupResource.histogramCell.label.query
        </meta>
        
        <meta attribute="foreign-key">
            on-delete=CASCADE
        </meta>

        <id name="oid" type="java.lang.String" column="OID">
            <generator class="assigned"/>
        </id>

        <many-to-one name="histogram" class="HistogramDef" column="HIST_ID" not-null="true">
            <meta attribute="alias">parentOID</meta>
        </many-to-one>
        <property name="cellNumber" column="CELL_NUMBER" type="int" length="5" not-null="true"/>

        <property name="unitType" type="string" column="UNIT_TYPE" length="64" not-null="true"/>

        <property name="lower" type="java.lang.Double" column="lower">
            <meta attribute="quantity">unitType</meta>
        </property>
        <property name="upper" type="java.lang.Double" column="upper">
            <meta attribute="quantity">unitType</meta>
        </property>
    </class>


    <!-- minestar.health.domain.metadata.PayloadHistogramCellDef root -->
    <class name="PayloadHistogramCellDef" table="PAYLOAD_CELL_DEF">
        <meta attribute="noDatabaseMetadata" inherit="false">true</meta>
        <meta attribute="table">
            tablespace=MW_OBJ
        </meta>
        <meta attribute="primary-key">
            tablespace=MW_IDXOBJ
        </meta>

        <meta attribute="viewproperty-label" inherit="false">
            type=string
            expression=lookupResource.histogramCell.label.query
        </meta>

         <meta attribute="viewproperty-category_num" inherit="false">
            type=int
            expression=lookupResource.histogramCell.category_num.query
        </meta>

        <id name="oid" type="java.lang.String" column="OID">
            <generator class="assigned"/>
        </id>

        <property name="category" column="CATEGORY" type="string"/>

        <property name="cellNumber" column="CELL_NUMBER" type="int" length="5"/>

        <property name="unitType" type="string" column="UNIT_TYPE" length="64"/>

        <property name="lower" type="java.lang.Double" column="lower">
            <meta attribute="quantity">unitType</meta>
        </property>

        <property name="upper" type="java.lang.Double" column="upper">
            <meta attribute="quantity">unitType</meta>
        </property>
    </class>
</hibernate-mapping>
